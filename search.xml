<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>面向开发的ubuntu系统分区方案介绍</title>
      <link href="/posts/12631/"/>
      <url>/posts/12631/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="系统分区"><a href="#系统分区" class="headerlink" title="系统分区"></a>系统分区</h1><p>在实际开发场景中，一种好的分区策略除了能save your time，很多时候还能save your ass，这点我是深有体会的。<br>所以我觉得很有必要分享下，自己多年使用和重装系统所得来的经验。我会从硬盘跟Linux系统这两个方向进行介绍，其中会讲解点原理性的东西以便于大家理解。</p><h1 id="硬盘"><a href="#硬盘" class="headerlink" title="硬盘"></a>硬盘</h1><p>就是存放数据的工具。它的类型主要就机械硬盘跟固态硬盘。</p><h2 id="机械硬盘"><a href="#机械硬盘" class="headerlink" title="机械硬盘"></a>机械硬盘</h2><p>Hard Disk Drive，简称HDD。它的内部构造可以参考<font color="blue">光驱+光盘</font>这个组合，光盘我们都有见过，要用光盘我们需要把它放到一个光驱里，然后就会听到电机转起来的声音，巨吵。这时光盘里的数据就通过光驱读出来了。</p><p>而硬盘无非就是一堆光盘叠起来，然后光驱也放到了一起。它跟“光驱+光盘”这个组合的根本区别在于数据的读写形式，如下图所示：</p><p><img src="https://s1.ax1x.com/2022/04/23/LWOF6P.png" alt="hdd"></p><p>一个用到的原理是光，而另一个是磁。所以一个用到光盘跟激光头，硬盘则是磁盘跟磁头。</p><h2 id="固态硬盘"><a href="#固态硬盘" class="headerlink" title="固态硬盘"></a>固态硬盘</h2><p>Solid State Drive，简称SSD。它的内部主要是一块电路板，上面嵌了控制器跟一堆闪存颗粒，如下图所示：</p><p><img src="https://s1.ax1x.com/2022/04/23/LWzTYD.png" alt="ssd"></p><p>其实可以把它当做一个U盘来看，只不过接口变了，然后多加了存储东西的元件罢了。</p><h2 id="硬盘格式"><a href="#硬盘格式" class="headerlink" title="硬盘格式"></a>硬盘格式</h2><p>如果把硬盘当作一本笔记本的话，那么硬盘格式所做的工作就是在规定笔记本每页纸张的大小。主要有MBR和GUID（GPT）两种格式。两者区别如下：</p><table><thead><tr><th>分区格式</th><th>出生日期</th><th>BIOS启动方式</th><th>特点</th></tr></thead><tbody><tr><td>MBR</td><td>早</td><td>Legacy</td><td>最多只支持2TB大的硬盘，最多支持分4个主分区或三个主分区和一个扩展分区，扩展分区下可以有多个逻辑分区</td></tr><tr><td>GPT</td><td>晚</td><td>UEFI</td><td>支持18EB大的硬盘且对分区数量没有限制，但没有限制是每个分区付出一点容量记录自身分区信息换来的</td></tr></tbody></table><p>根据上表就可以合理选择自己要用的硬盘格式了。</p><h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><p>这个操作系统开发者应该会比较熟悉，我以自己用得比较多的Ubuntu系统为例，简单介绍下跟我们分区相关的内容。</p><h2 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h2><p>主要以文件的形式来管理磁盘，我们看得到的文件类型、创建修改日期等都是文件系统负责的。<br>Linux 支持很多文件系统格式，不同的格式有其不同的特点，下表是跟我们安装Ubuntu系统有关的格式。</p><table><thead><tr><th>文件格式</th><th>特点</th></tr></thead><tbody><tr><td>ext2</td><td>Linux 最传统的磁盘文件系统，稳定可靠，速度快，就是不支持日志，也就是系统崩了不好恢复刚做的修改。</td></tr><tr><td>ext3</td><td>基于原来的 ext2 开发，添加了日志功能，所以它跟 ext2 格式很容易实现相互转换</td></tr><tr><td>ext4</td><td>基于 ext3 再次升级的格式，它主要提升了文件系统中卷、文件、目录的最大尺寸，表现它支持最大大小为 1 EB 的卷、最大大小为 16 TB 的文件和无限个子目录</td></tr></tbody></table><p>根据这个表格应该很好确定我们等下要用哪个格式了，然后有关更多其他fs格式的介绍可以在这里查看<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="fh是file system的缩写，这是[Ubuntu文件系统手册链接](http://manpages.ubuntu.com/manpages/bionic/zh_CN/man5/fs.5.html)">[1]</span></a></sup>。<br>最后补充一点，就是硬盘格式跟文件系统格式的区别，这个可能很容易搞混。</p><blockquote><p>就还是把硬盘当作一本笔记本，硬盘格式初始化后笔记本每页纸张大小就确定了，而文件系统格式相当于在规定每页纸上日期，天气的位置和每个划线的间距。</p></blockquote><h2 id="系统目录"><a href="#系统目录" class="headerlink" title="系统目录"></a>系统目录</h2><p>Linux的系统目录真的非常漂亮，所有的文件皆挂载在一个叫 &#x2F; 的目录下，这个 &#x2F; 也叫做根目录。</p><p>而根目录下的一级目录大多也是规定好的，由下图这几个关键目录组成，这些目录下各自存放了用于完成不同工作的文件。下图截取自fhs文档，感兴趣的朋友可以在这里了解更多关于linux的fhs介绍<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="fhs是Filesystem Hierarchy Standard的缩写，[这是官方文档地址](http://www.pathname.com/fhs/)">[2]</span></a></sup></p><p><img src="https://s1.ax1x.com/2022/04/24/L5J6AA.png" alt="fhs"></p><p>下面是我的翻译工作：</p><table><thead><tr><th>目录名</th><th>作用</th></tr></thead><tbody><tr><td>&#x2F;bin</td><td>存放基本的<font color="red">二进制文件</font>，一般我们在Linux命令行里输的命令都是来自于&#x2F;bin目录</td></tr><tr><td>&#x2F;boot</td><td>存放系统的<font color="red">开机引导</font>文件，占用空间不大，一般几百M</td></tr><tr><td>&#x2F;dev</td><td>存放访问<font color="red">硬件设备的接口</font>文件，用来访问硬盘，内存等各个硬件</td></tr><tr><td>&#x2F;etc</td><td>存放<font color="red">系统配置文件</font>，用户管理，网络配置都在这个目录下可以改，相当于Windows下的注册表</td></tr><tr><td>&#x2F;lib</td><td>存放<font color="red">动态库跟内核模块</font>文件，给程序调用的</td></tr><tr><td>&#x2F;media</td><td>作为可移动存储设备的挂载点，用来访问u盘，cd光盘的内容</td></tr><tr><td>&#x2F;mnt</td><td>作为暂时访问其他文件系统的挂载点，实际作用同上，两者完全兼容</td></tr><tr><td>&#x2F;opt</td><td>存放附加程序安装包的，也就是后来自己想下的第三方软件都可以放这里，详见fhs文档3.13处</td></tr><tr><td>&#x2F;sbin</td><td>存放<font color="red">给系统还有root用户调用</font>的基本二进制文件</td></tr><tr><td>&#x2F;srv</td><td>存放系统服务产生的数据</td></tr><tr><td>&#x2F;tmp</td><td>存放临时数据的文件</td></tr><tr><td>&#x2F;usr</td><td>存放共享的可读文件，<font color="red">大多数常用软件、c&#x2F;c++头文件和库</font>都在这里</td></tr><tr><td>&#x2F;var</td><td>存放变量数据，它里面记录了所有程序的<font color="red">日志</font>还有系统日志等</td></tr></tbody></table><p>另外还有几个重要的目录，&#x2F;root是管理员的的家目录、&#x2F;home是所有用户的家目录、&#x2F;proc是存放进程信息的目录。</p><h1 id="正式分区"><a href="#正式分区" class="headerlink" title="正式分区"></a>正式分区</h1><p>有了以上这些内容铺垫，可以来介绍ubuntu系统分区方案了。</p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>首先以我512g的固态为例，根据硬盘分区的知识，容量 &lt; 2T，那就用MBR格式初始化。<br>然后根据对Linux系统的知识，可以考虑将<font color="red">系统</font>跟<font color="red">用户数据</font>分离的原则进行分区。</p><ul><li>系统：linux系统根目录（&#x2F;）、引导系统（&#x2F;boot）</li><li>用户数据：用户家目录（&#x2F;home）、用户工具链（&#x2F;usr）</li></ul><p>这样做的好处在于系统崩了重装或备份还原时，就不会牵连到用户的数据，&#x2F;usr用户工具链装冲突了也不影响系统，系统引导出问题了修复引导就行了。下面是我的分区策略供大家参考。</p><table><thead><tr><th>目录</th><th>分区格式</th><th>分区大小</th></tr></thead><tbody><tr><td>&#x2F;</td><td>主分区</td><td>20G</td></tr><tr><td>&#x2F;boot</td><td>主分区</td><td>600MB</td></tr><tr><td>&#x2F;usr</td><td>逻辑分区</td><td>80G</td></tr><tr><td>&#x2F;home</td><td>逻辑分区</td><td>100G</td></tr><tr><td>未知</td><td>逻辑分区</td><td>剩余大小</td></tr></tbody></table><p>另外提一点，关于&#x2F;swap分区，它是物理内存不够用的时候，把硬盘内存中的一部分空间释放出来，借给程序使用的。所以一般内存够用没必要划这个分区，我建议不要拿硬盘寿命换内存条寿命。</p><h2 id="还原"><a href="#还原" class="headerlink" title="还原"></a>还原</h2><p>还原时记得按原来设置的文件系统格式选择对应的分区，然后需要reset的分区点上初始化选项即可。</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">fh是file system的缩写，这是<a href="http://manpages.ubuntu.com/manpages/bionic/zh_CN/man5/fs.5.html">Ubuntu文件系统手册链接</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">fhs是Filesystem Hierarchy Standard的缩写，<a href="http://www.pathname.com/fhs/">这是官方文档地址</a><a href="#fnref:2" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 环境搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一份借助frp实现内网穿透的简要说明</title>
      <link href="/posts/16409/"/>
      <url>/posts/16409/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="frp"><a href="#frp" class="headerlink" title="frp"></a>frp</h1><p>fast reverse proxy(即快速反向代理)，可以把接在NAT上的本地设备的端口映射到公网上，让本地的设备也能像服务器一样被公网访问。</p><h2 id="软件下载"><a href="#软件下载" class="headerlink" title="软件下载"></a>软件下载</h2><p>无论服务端还是客户端，下载地址都是这里。<a href="https://github.com/fatedier/frp/releases">点击直达</a></p><ul><li>服务端： 具有公网ip的服务器</li><li>客户端： 需要被公网访问的本地设备</li></ul><h2 id="软件使用"><a href="#软件使用" class="headerlink" title="软件使用"></a>软件使用</h2><p>下载下来的压缩包解压后，进入文件目录，主要关注以下四个文件：</p><ul><li>frps: 服务端的可执行文件</li><li>frps.ini: 服务端的配置文件</li><li>frpc: 客户端的可执行文件</li><li>frpc.ini: 客户端的配置文件</li></ul><p>进入软件目录后，运行软件命令如下</p><blockquote><p>  .&#x2F;frps -c frps.ini</p></blockquote><p>运行客户端的命令</p><blockquote><p>  .&#x2F;frpc -c frpc.ini</p></blockquote><h2 id="frps-ini"><a href="#frps-ini" class="headerlink" title="frps.ini"></a>frps.ini</h2><p>服务端的配置很简单，bind_port定义监听哪个端口，为连接到这个端口的数据做转发。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port = 7000</span><br></pre></td></tr></table></figure><p>但需<font color="red">注意服务器的防火墙要打开这个端口。</font>，ubuntu系统可以用下面这个命令放行端口</p><blockquote><p>sudo ufw allow “port-num” </p></blockquote><p>“port-num”：填需要放行的端口号</p><p>可以通过下面这个命令查看当前防火墙策略，以检查自己要用到的端口没被防火墙过滤。</p><blockquote><p>sudo ufw status</p></blockquote><h2 id="frpc-ini"><a href="#frpc-ini" class="headerlink" title="frpc.ini"></a>frpc.ini</h2><p>客户端的配置如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = xxx.xxx.xxx.229   <span class="comment">#服务器的ip地址</span></span><br><span class="line">server_port = 7000              <span class="comment">#服务器提供frp服务的端口</span></span><br><span class="line"></span><br><span class="line">[RoadNetEdit]           <span class="comment">#这个名字随便取，主要是备注</span></span><br><span class="line"><span class="built_in">type</span> = tcp                  <span class="comment">#端口协议，默认TCP</span></span><br><span class="line">local_ip = 127.0.0.1        <span class="comment">#本地ip地址</span></span><br><span class="line">local_port = 8086           <span class="comment">#本地需要暴露到公网的服务端口</span></span><br><span class="line">remote_port = 30000         <span class="comment">#服务端提供远程访问的端口</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#参数同上</span></span><br><span class="line">[RobotEdit]</span><br><span class="line"><span class="built_in">type</span> = tcp</span><br><span class="line">local_ip = 127.0.0.1</span><br><span class="line">local_port = 8088</span><br><span class="line">remote_port = 30001</span><br></pre></td></tr></table></figure><p>注： 原来通过”local_ip：local_port”访问本地服务，现在可通过”server_addr：remote_port”访问原来的服务。<font color="red">所以记得服务器的防火墙打开remote_port来提供服务！</font></p><h1 id="systemd自启动"><a href="#systemd自启动" class="headerlink" title="systemd自启动"></a>systemd自启动</h1><p>为了让程序自己开机就运行，需要把该程序写入到systemd管理的服务(Unit)中。首先以frpc为例，通过如下命令创建Uint配置文件</p><blockquote><p>vi &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;frpc.service</p></blockquote><p>在vi界面下按i进入insert模式，然后复制以下内容到这个文件中。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Frp Service <span class="comment">#简单描述</span></span><br><span class="line">After=network.target    <span class="comment">#在network.target之后启动</span></span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=idle               <span class="comment">#服务类型，idle会等待所有任务处理完成后，才开始执行。</span></span><br><span class="line">User=nobody             <span class="comment">#运行此程序的用户</span></span><br><span class="line">Restart=on-failure      <span class="comment">#失败时重启</span></span><br><span class="line">RestartSec=60s          <span class="comment">#重启间隔60s</span></span><br><span class="line">ExecStart=/home/teemo/frp/frpc -c /home/teemo/frp/frpc.ini    <span class="comment">#执行的命令</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target  </span><br></pre></td></tr></table></figure><p>然后执行下面的命令重载Systemd</p><blockquote><p>  systemctl daemon-reload</p></blockquote><p>现在通过如下命令就能启动frpc服务了</p><blockquote><p>  systemctl start frpc</p></blockquote><p>输入如下命令使能frpc服务的开机自起</p><blockquote><p>  systemctl enable frpc</p></blockquote><p>可以通过如下命令查看服务的运行状态</p><blockquote><p>  systemctl status frpc</p></blockquote><p>下面是成功运行的截图：<br><img src="https://s1.ax1x.com/2022/04/22/LRF8Xj.png" alt="status"></p><ul><li>在Loaded标签下我们可以看到enabled说明开机自起设置成功。</li><li>在Active标签下我们可以在到绿色的active(running)说明程序正常运行。</li><li>然后最底下我们可以看到程序的运行日志。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 服务器 </tag>
            
            <tag> 环境搭建 </tag>
            
            <tag> 网络 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于waypoint的路径规划与控制算法的实现（下）</title>
      <link href="/posts/16494/"/>
      <url>/posts/16494/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="关于本文"><a href="#关于本文" class="headerlink" title="关于本文"></a>关于本文</h1><p>参考上一篇文章————<a href="../6786/">基于waypoint的路径规划与控制算法的实现（上）</a></p><h1 id="路径跟随"><a href="#路径跟随" class="headerlink" title="路径跟随"></a>路径跟随</h1><p>WayPointFollower程序主要完成了这些工作，加载路径点，路径可视化，获取当前位姿，计算发布控制指令。</p><h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><p>下面是轨迹跟随算法的流程图。<br><img src="https://s1.ax1x.com/2022/05/01/OCXCQO.png" alt="WayPointFollower"></p><p>补充一点，加载路径点后面少了可视化部分，因为我最开始没打算写的，后来为了调试方便才加的。</p><h2 id="难点"><a href="#难点" class="headerlink" title="难点"></a>难点</h2><p>路径跟随最难处理的地方在于转角控制的计算了，首先来看下实际循迹过程会出现的两种情况。<br>下面是第一种情况，也是比较理想的情况，根据当前位置获取到的最近路径点刚好在前面。</p><p><img src="https://s1.ax1x.com/2022/05/01/OCXSW6.png" alt="情况1"></p><p>这时我们根据当前位置前后两个路径点的yaw角偏移就能计算出当前控制转角的大小，如公式(1)所示：</p><p>$$(Y_n-Y_c)\times\alpha+(Y_n-Y_b)\times\beta \tag{1}$$</p><blockquote><p>其中Y_n、Y_c、Y_b分别为当前yaw角，最近路径点yaw角跟后一个路径点的yaw角，$\alpha$ 跟 $\beta$ 为不同的固定权重且满足等式 $\alpha+\beta&#x3D;1$</p></blockquote><p>另一种情况如下所示，根据当前位置获取到的最近路径点在后面了，这时再根据最近点和它后一个路径点来计算会发生较大的误差。</p><p><img src="https://s1.ax1x.com/2022/05/01/OCOzJx.png" alt="情况2"></p><p>理想的算法是找到最近的两个路径点，然后根据它们相对于当前位置的距离来分配权重大小（距离近权重大），在把权重放进控制转角计算中，如公式(2.1)所示：<br>$$(Y_n-Y_{c1})\times\alpha+(Y_n-Y_{c2})\times\beta \tag{2.1}$$</p><blockquote><p>其中$Y_{c1}$、$Y_{c2}$分别为最近路径点yaw的角跟第二近的路径点yaw角。</p></blockquote><p>需要注意的是$\alpha$ 跟 $\beta$在这里是根据距离比重浮动变化的，参考式(2.2)：</p><p>$$<br>\begin{align}<br>\alpha&#x3D;d_1 \div (d_1+d_2)  , \tag{2.2}<br>\<br>\beta&#x3D;d_2 \div (d_1+d_2)<br>\end{align}<br>$$</p><blockquote><p>其中 $d_1$ 为当前位置与最近路径点的距离， $d_2$ 为当前位置与第二近的路径点距离。</p></blockquote><p>但实际上路径点并没有离的那么远，别忘了我们采样频率是2hz，这个频率在低速情况下采集的路径点是非常密的，所以只要权重分配到位，第二种情况是可以跟第一种情况近似处理。</p><h2 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h2><p>跟waypoint_saver一样，WayPointFollower的程序入口也在最底下<code>if __name__ == &quot;__main__&quot;:</code>那里，主循环跑的是<code>WayPointFollower()</code>对象的<code>run()</code>函数。注释应该写的很详细了，这里就不再赘述了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> rospy   </span><br><span class="line"><span class="keyword">import</span> tf    </span><br><span class="line"><span class="keyword">from</span> tf_conversions <span class="keyword">import</span> transformations  </span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">from</span> geometry_msgs.msg <span class="keyword">import</span> Twist</span><br><span class="line"><span class="keyword">from</span> visualization_msgs.msg <span class="keyword">import</span> Marker</span><br><span class="line"><span class="keyword">from</span> visualization_msgs.msg <span class="keyword">import</span> MarkerArray</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WayPointFollower</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._seq = <span class="number">0</span>   <span class="comment"># use to figure out visiualized waypoint</span></span><br><span class="line">        self._wpIdx = <span class="number">0</span></span><br><span class="line">        self._goalIdx = <span class="number">0</span></span><br><span class="line">        self._wps = []</span><br><span class="line">        self._cur_pose=[]</span><br><span class="line">        self._filename = <span class="string">&#x27;waypoints.csv&#x27;</span></span><br><span class="line">        self._stop_flag = <span class="literal">False</span></span><br><span class="line">        self.v = Twist()</span><br><span class="line">        self.tf_listener = tf.TransformListener()</span><br><span class="line">        self.markerArray = MarkerArray()</span><br><span class="line">        self.cmd_pub = rospy.Publisher(<span class="string">&#x27;cmd_vel&#x27;</span>,Twist,queue_size=<span class="number">10</span>)</span><br><span class="line">        self.rviz_pub = rospy.Publisher(<span class="string">&#x27;waypoints&#x27;</span>, MarkerArray, queue_size=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_load_waypoints</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Load waypoints to a list &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(self._filename,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            rdr = csv.reader(f)</span><br><span class="line">            <span class="keyword">for</span> i,row <span class="keyword">in</span> <span class="built_in">enumerate</span>(rdr):</span><br><span class="line">                <span class="keyword">if</span> i&gt;<span class="number">0</span>:     <span class="comment"># remove header</span></span><br><span class="line">                    <span class="comment"># convert str to float</span></span><br><span class="line">                    wp = []</span><br><span class="line">                    <span class="keyword">for</span> p <span class="keyword">in</span> row:</span><br><span class="line">                        wp.append(<span class="built_in">float</span>(p))</span><br><span class="line">                    self._wps.append(wp)</span><br><span class="line">        <span class="comment"># record final waypoint index</span></span><br><span class="line">        self._goalIdx = <span class="built_in">len</span>(self._wps)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># def _preprocess_wps(self):</span></span><br><span class="line">    <span class="comment">#     &#x27;&#x27;&#x27; not used yet &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">#     offset = 7</span></span><br><span class="line">    <span class="comment">#     for i in self._wps:</span></span><br><span class="line">    <span class="comment">#         if offset &gt;= self._goalIdx:</span></span><br><span class="line">    <span class="comment">#             break</span></span><br><span class="line">    <span class="comment">#         max = 0</span></span><br><span class="line">    <span class="comment">#         idx = 0</span></span><br><span class="line">    <span class="comment">#         print(len(self._wps[i:offset]))</span></span><br><span class="line">    <span class="comment">#         for wp in self._wps[:offset]:</span></span><br><span class="line">    <span class="comment">#             if wp[-1] &gt; max:</span></span><br><span class="line">    <span class="comment">#                 max = wp[-1]</span></span><br><span class="line">    <span class="comment">#                 idx = wp[0]</span></span><br><span class="line">    <span class="comment">#         print(max,idx)</span></span><br><span class="line">    <span class="comment">#         offset+=1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_visualize_wps</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Visualize waypoints in rviz &#x27;&#x27;&#x27;</span></span><br><span class="line">        ourmarkerArray = []</span><br><span class="line">        <span class="keyword">for</span> wp <span class="keyword">in</span> self._wps:</span><br><span class="line">            marker = Marker()</span><br><span class="line">            marker.header.frame_id = <span class="string">&quot;/map&quot;</span></span><br><span class="line">            marker.header.stamp = rospy.Time.now()</span><br><span class="line">            marker.header.seq = self._seq</span><br><span class="line">            marker.<span class="built_in">type</span> = marker.SPHERE</span><br><span class="line">            marker.action = marker.ADD</span><br><span class="line">            marker.<span class="built_in">id</span> = wp[<span class="number">0</span>]</span><br><span class="line">            marker.scale.x = <span class="number">0.2</span></span><br><span class="line">            marker.scale.y = <span class="number">0.2</span></span><br><span class="line">            marker.scale.z = <span class="number">0.2</span></span><br><span class="line">            marker.color.a = <span class="number">1.0</span></span><br><span class="line">            marker.color.r = <span class="number">1.0</span></span><br><span class="line">            marker.color.g = <span class="number">1.0</span></span><br><span class="line">            marker.color.b = <span class="number">0.0</span></span><br><span class="line">            marker.pose.orientation.w = <span class="number">1.0</span></span><br><span class="line">            marker.pose.position.x = wp[<span class="number">1</span>]</span><br><span class="line">            marker.pose.position.y = wp[<span class="number">2</span>]</span><br><span class="line">            marker.pose.position.z = <span class="number">0</span></span><br><span class="line">            </span><br><span class="line">            ourmarkerArray.append(marker)</span><br><span class="line">        self._seq += <span class="number">1</span></span><br><span class="line">        self.markerArray = ourmarkerArray</span><br><span class="line">        self.rviz_pub.publish(self.markerArray)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_current_pos</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Get current position &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            trans, rot = self.tf_listener.lookupTransform(<span class="string">&#x27;/map&#x27;</span>, <span class="string">&#x27;/base_link&#x27;</span>, rospy.Time(<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">except</span> (tf.LookupException, tf.ConnectivityException, tf.ExtrapolationException):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        roll,pitch,yaw = transformations.euler_from_quaternion(rot)</span><br><span class="line">        x = trans[<span class="number">0</span>]</span><br><span class="line">        y = trans[<span class="number">1</span>]</span><br><span class="line">        self._cur_pose = [x,y,yaw]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self._cur_pose):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_closet_wpIdx</span>(<span class="params">self</span>): </span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; get closest waypoint from remaining waypoints &#x27;&#x27;&#x27;</span>  </span><br><span class="line">        cur_wpIdx = self._wpIdx</span><br><span class="line">        <span class="keyword">if</span> self._get_current_pos(): </span><br><span class="line">            <span class="built_in">min</span> = math.sqrt(math.<span class="built_in">pow</span>(self._cur_pose[<span class="number">0</span>]-self._wps[<span class="number">0</span>][<span class="number">1</span>],<span class="number">2</span>)+math.<span class="built_in">pow</span>(self._cur_pose[<span class="number">1</span>]-self._wps[<span class="number">0</span>][<span class="number">2</span>],<span class="number">2</span>))</span><br><span class="line">            <span class="keyword">for</span> wp <span class="keyword">in</span> self._wps[cur_wpIdx:-<span class="number">1</span>]:</span><br><span class="line">                dst = math.sqrt(math.<span class="built_in">pow</span>(self._cur_pose[<span class="number">0</span>]-wp[<span class="number">1</span>],<span class="number">2</span>)+math.<span class="built_in">pow</span>(self._cur_pose[<span class="number">1</span>]-wp[<span class="number">2</span>],<span class="number">2</span>))</span><br><span class="line">                <span class="keyword">if</span> dst &lt; <span class="built_in">min</span>:</span><br><span class="line">                    <span class="built_in">min</span> = dst</span><br><span class="line">                    self._wpIdx = <span class="built_in">int</span>(wp[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_reach_the_goal</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Check if reach the goal &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self._wpIdx+<span class="number">1</span> == self._goalIdx:</span><br><span class="line">            self._stop_flag = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_send_vel_cmd</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Compute and send velocity command &#x27;&#x27;&#x27;</span></span><br><span class="line">        self.v.linear.x = <span class="number">0.1</span></span><br><span class="line">        prev_wp_angle = self._wps[self._wpIdx + <span class="number">1</span>][-<span class="number">1</span>] - self._cur_pose[-<span class="number">1</span>]</span><br><span class="line">        back_wp_angle = self._wps[self._wpIdx][-<span class="number">1</span>] - self._cur_pose[-<span class="number">1</span>]</span><br><span class="line">        self.v.angular.z = (prev_wp_angle * <span class="number">4</span> + back_wp_angle * <span class="number">6</span>)/<span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> self.v.angular.z &gt; <span class="number">0.5</span>:</span><br><span class="line">            self.v.angular.z = <span class="number">0.8</span> * self.v.angular.z</span><br><span class="line">        self.cmd_pub.publish(self.v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_stop</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; Send stop command &#x27;&#x27;&#x27;</span></span><br><span class="line">        self.v.linear.x = <span class="number">0</span></span><br><span class="line">        self.v.angular.z = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> self._stop_flag:</span><br><span class="line">            self.cmd_pub.publish(self.v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        self._load_waypoints()</span><br><span class="line">        <span class="comment"># self._preprocess_wps()</span></span><br><span class="line">        r = rospy.Rate(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():</span><br><span class="line">            self._visualize_wps()</span><br><span class="line">            <span class="keyword">if</span> self._reach_the_goal():</span><br><span class="line">                self._stop()</span><br><span class="line">            <span class="keyword">if</span> self._get_current_pos():</span><br><span class="line">                self._get_closet_wpIdx()</span><br><span class="line">                self._send_vel_cmd()</span><br><span class="line">            r.sleep()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;wayPoint_follower&#x27;</span>)   </span><br><span class="line">    follower = WayPointFollower()  </span><br><span class="line">    follower.run()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS </tag>
            
            <tag> Autonomous Driving </tag>
            
            <tag> Motion Planning </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于waypoint的路径规划与控制算法的实现（上）</title>
      <link href="/posts/6786/"/>
      <url>/posts/6786/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="关于本文"><a href="#关于本文" class="headerlink" title="关于本文"></a>关于本文</h1><p>旨在解决差动转向的机器人在结构化道路中从A跑到B的问题。</p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我看了下，室内移动机器人的slam自动导航算法有很多，但大多基于 A* 或改进 A* 算法实现的，显然不适用在结构化道路中。<br>那我想了下，自己接触过的Autoware的Waypoint_planner算法应该能实现，但Autoware面向阿克曼底盘，没法直接拿来用。</p><p>为了尽量避免Autoware被我的黑暗料理污染（基于keep it pure的原则），我决定自己用python写个类似的算法来解决上面的问题，就不在Autoware的代码上动手脚了。</p><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>本算法主要由waypoint_saver跟waypoint_follower这两部分组成，一个录制路径，一个跟随路径。本文主要介绍路径点数据格式跟waypoint_saver算法及设计思路。</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>本算法只提供简单的规划和控制部分，所以跑本算法有以下几点prerequisitions：</p><ol><li>python2</li><li>ROS1</li><li>已实现定位，能提供baselink到map的tf（可修改）</li></ol><p>前两点是没什么异议的，至于第三点定位部分的实现可以有很多，只要能以tf的形式发布小车的定位信息即可，本算法定位是Autoware自带的ndt配准算法实现的。</p><h1 id="路径录制"><a href="#路径录制" class="headerlink" title="路径录制"></a>路径录制</h1><p>下面正式介绍waypoint_saver算法。</p><h2 id="路径点格式"><a href="#路径点格式" class="headerlink" title="路径点格式"></a>路径点格式</h2><p>首先是路径点数据格式的设计，从实际控制的角度出发，差动型小车就纵向跟横向控制，也就是控制速度跟转角就够了。</p><p>我想了下，速度可以给个定值，这样就只需要转角控制即可。所以路径点只要提供以下信息：</p><ol><li>位置信息：录制小车当前在地图上的x跟y坐标</li><li>姿态信息：录制小车当前在地图上的yaw角</li><li>索引值：用来管理这些路径点</li></ol><p>存放路径点的文件类型我采用跟Autoware一样的csv文件格式，一方面它看起来直观另一方面它用起来也方便，所以最终数据存放格式如下所示：</p><table><thead><tr><th>Idx</th><th>x</th><th>y</th><th>yaw</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>…</td><td>…</td><td>…</td><td>…</td></tr></tbody></table><h2 id="流程图"><a href="#流程图" class="headerlink" title="流程图"></a>流程图</h2><p>下面是路径录制算法的流程图。它的原理很简单，基于时间间隔对定位信息进行采样，只要隔一段时间能获取到定位信息就把信息写入到csv文件中，直到你把程序（<kbd>Ctrl</kbd>+<kbd>c</kbd>）kill掉就结束录制。</p><p><img src="https://s1.ax1x.com/2022/05/01/OCX9SK.png" alt="waypoint_saver"></p><h2 id="主程序"><a href="#主程序" class="headerlink" title="主程序"></a>主程序</h2><p>waypoint_saver我写的还是蛮通俗的，所以简单提下，程序入口在最底下<code>if __name__ == &quot;__main__&quot;:</code>那里，主循环跑的是<code>WayPointSaver()</code>对象的<code>_run()</code>函数。结和上面的流程图来看应该很清晰，它一直在获取路径点、处理路径点、写入路径点到文件。</p><p>这里路径点处理部分本来留给自己优化的，想着可能对路径点需要做平滑滤波等处理，但后来发现控制程序里做点小处理也能跑，就没优化了。如果需要读者可自行修改。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rospy   </span><br><span class="line"><span class="keyword">from</span> tf_conversions <span class="keyword">import</span> transformations     </span><br><span class="line"><span class="keyword">import</span> tf    </span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WayPointSaver</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._pIdx = <span class="number">0</span></span><br><span class="line">        self._wp = []</span><br><span class="line">        self._header = [<span class="string">&#x27;Idx&#x27;</span>,<span class="string">&#x27;x&#x27;</span>,<span class="string">&#x27;y&#x27;</span>,<span class="string">&#x27;yaw&#x27;</span>]</span><br><span class="line">        self._filename = <span class="string">&#x27;waypoints.csv&#x27;</span></span><br><span class="line">        self.tf_listener = tf.TransformListener()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(self._filename,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                wtr = csv.writer(f)</span><br><span class="line">                wtr.writerow(self._header)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_wp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; get current pose &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            trans, rot = self.tf_listener.lookupTransform(<span class="string">&#x27;/map&#x27;</span>, <span class="string">&#x27;/base_link&#x27;</span>, rospy.Time(<span class="number">0</span>))</span><br><span class="line">        <span class="keyword">except</span> (tf.LookupException, tf.ConnectivityException, tf.ExtrapolationException):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        roll,pitch,yaw = transformations.euler_from_quaternion(rot)  </span><br><span class="line">        x = trans[<span class="number">0</span>]</span><br><span class="line">        y = trans[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">and</span> y:</span><br><span class="line">            self._wp = [self._pIdx, x, y, yaw]</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_process_wp</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; process points &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="comment"># your can put your own code here</span></span><br><span class="line">        self._pIdx += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_write_file</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; write point to file &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(self._filename,<span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            wtr = csv.writer(f)</span><br><span class="line">            wtr.writerow(self._wp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27; main loop &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self._get_wp():</span><br><span class="line">            self._process_wp()</span><br><span class="line">            self._write_file()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    rospy.init_node(<span class="string">&#x27;wayPoint_saver&#x27;</span>)   </span><br><span class="line">    saver = WayPointSaver()</span><br><span class="line">    r = rospy.Rate(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> rospy.is_shutdown():  </span><br><span class="line">        saver.run()</span><br><span class="line">        r.sleep()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ROS </tag>
            
            <tag> Autonomous Driving </tag>
            
            <tag> Motion Planning </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于ROS Navigation小车失控的问题</title>
      <link href="/posts/55934/"/>
      <url>/posts/55934/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>当你在rivz看到小车规划出来的全局路径是没问题的，但小车却会跑歪，那就说明小车失控了。</p><p>这里失控的原因大概率是控制命令下发不及时，但控制频率丢失大多会跟local_costmap的更新频率丢失一起出现，在小车程序运行的终端会打印类似如下的警告：</p><blockquote><p>[Warn]： Control loop missed its desired rate of xxxHz… the loop actually took xx seconds</br><br>[Warn]： Map update loop missed its desired rate of xxxHz… the loop actually took xx seconds</p></blockquote><h1 id="原因追溯"><a href="#原因追溯" class="headerlink" title="原因追溯"></a>原因追溯</h1><p>该现象主要是<font color='red'>小车周边代价地图更新太慢</font>导致的，而地图更新慢，跟生成代价地图的参数以及小车自身的算力有关。<a href="./#%E8%A7%A3%E5%86%B3%E6%8E%AA%E6%96%BD">&gt; 直接看解决措施 &lt;</a><br>根据终端报的警告，我们可以把问题追溯到move_base.cpp文件下的executeCb()函数和costmap_2d_ros.cpp文件下的mapUpdateLoop()函数。</p><h2 id="1-costmap"><a href="#1-costmap" class="headerlink" title="1.costmap"></a>1.costmap</h2><p>可以先看下costmap报警告的代码，跟我们遇到的问题关系不大的代码，我都用…把他们省略了，这样方便我们认识代码和排查原因。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Costmap2DROS::mapUpdateLoop</span><span class="params">(<span class="type">double</span> frequency)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">while</span> (nh.<span class="built_in">ok</span>() &amp;&amp; !map_update_thread_shutdown_)</span><br><span class="line">  &#123;</span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">updateMap</span>();</span><br><span class="line">    ...</span><br><span class="line">    r.<span class="built_in">sleep</span>();</span><br><span class="line">    <span class="comment">// make sure to sleep for the remainder of our cycle time</span></span><br><span class="line">    <span class="keyword">if</span> (r.<span class="built_in">cycleTime</span>() &gt; ros::<span class="built_in">Duration</span>(<span class="number">1</span> / frequency))</span><br><span class="line">      <span class="built_in">ROS_WARN</span>(<span class="string">&quot;Map update loop missed its desired rate of %.4fHz... the loop actually took %.4f seconds&quot;</span>, frequency,</span><br><span class="line">               r.<span class="built_in">cycleTime</span>().<span class="built_in">toSec</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>很明显mapUpdateLoop()这个函数一直在调用updateMap()函数来更新局部地图，然后检测更新超时就报警。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Costmap2DROS::updateMap</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!stop_updates_)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get global pose</span></span><br><span class="line">    geometry_msgs::PoseStamped pose;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">getRobotPose</span> (pose))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">double</span> x = pose.pose.position.x,</span><br><span class="line">             y = pose.pose.position.y,</span><br><span class="line">             yaw = tf2::<span class="built_in">getYaw</span>(pose.pose.orientation);</span><br><span class="line">      layered_costmap_-&gt;<span class="built_in">updateMap</span>(x, y, yaw);</span><br><span class="line">      geometry_msgs::PolygonStamped footprint;</span><br><span class="line">      footprint.header.frame_id = global_frame_;</span><br><span class="line">      footprint.header.stamp = ros::Time::<span class="built_in">now</span>();</span><br><span class="line">      <span class="built_in">transformFootprint</span>(x, y, yaw, padded_footprint_, footprint);</span><br><span class="line">      footprint_pub_.<span class="built_in">publish</span>(footprint);</span><br><span class="line">      initialized_ = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后updateMap()函数主要获取小车位姿信息，以这个位姿为中心更新地图并添加小车的footprint，最后发布出去。<br>其实分析到这，已经能预料到这是局部地图参数欠优化的问题了。</p><h2 id="2-move-base"><a href="#2-move-base" class="headerlink" title="2.move_base"></a>2.move_base</h2><p>不过我们还是再来看下move_base吧，首先是executeCb()函数：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">MoveBase::executeCb</span><span class="params">(<span class="type">const</span> move_base_msgs::MoveBaseGoalConstPtr&amp; move_base_goal)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">while</span>(n.<span class="built_in">ok</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      ...</span><br><span class="line">      <span class="keyword">if</span>(as_-&gt;<span class="built_in">isPreemptRequested</span>())&#123;...</span><br><span class="line">      ...</span><br><span class="line">      <span class="comment">//the real work on pursuing a goal is done here</span></span><br><span class="line">      <span class="type">bool</span> done = <span class="built_in">executeCycle</span>(goal, global_plan);</span><br><span class="line">      <span class="comment">//if we&#x27;re done, then we&#x27;ll return from execute</span></span><br><span class="line">      <span class="keyword">if</span>(done)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      ...</span><br><span class="line">      r.<span class="built_in">sleep</span>();</span><br><span class="line">      <span class="comment">//make sure to sleep for the remainder of our cycle time</span></span><br><span class="line">      <span class="keyword">if</span>(r.<span class="built_in">cycleTime</span>() &gt; ros::<span class="built_in">Duration</span>(<span class="number">1</span> / controller_frequency_) &amp;&amp; state_ == CONTROLLING)</span><br><span class="line">        <span class="built_in">ROS_WARN</span>(<span class="string">&quot;Control loop missed its desired rate of %.4fHz... the loop actually took %.4f seconds&quot;</span>, controller_frequency_, r.<span class="built_in">cycleTime</span>().<span class="built_in">toSec</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>可以很方便地看出executeCb()函数一直在检测是否有新的抢占试请求（即新的导航点Nav Goal）,有的话他会调用plan线程为新目标规划全局路径，其次他会一直执行executeCycle()函数直到done为真，即到达目标点才会退出，没到终点的话借助sleep()方法来满足我们设定的控制频率，最后是我们报警告的地方，当以上代码的执行时间大于设定的控制时间时就会警告。<br>那是哪段代码执行太久了呢？新目标在小车运行中我们是没有添加的，而且即使添加了目标，也只是调用一个plan线程在外面并行地规划全局路径，这里的代码会继续执行下去，那就到executeCycle()这个函数了，代码如下，同样，无关的代码被我省略了。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">MoveBase::executeCycle</span><span class="params">(geometry_msgs::PoseStamped&amp; goal, std::vector&lt;geometry_msgs::PoseStamped&gt;&amp; global_plan)</span></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//we need to be able to publish velocity commands</span></span><br><span class="line">    geometry_msgs::Twist cmd_vel;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//the move_base state machine, handles the control logic for navigation</span></span><br><span class="line">    <span class="keyword">switch</span>(state_)&#123;</span><br><span class="line">      <span class="comment">//if we are in a planning state, then we&#x27;ll attempt to make a plan</span></span><br><span class="line">      <span class="keyword">case</span> PLANNING:</span><br><span class="line">        ...</span><br><span class="line">      <span class="comment">//if we&#x27;re controlling, we&#x27;ll attempt to find valid velocity commands</span></span><br><span class="line">      <span class="keyword">case</span> CONTROLLING:</span><br><span class="line">        ...</span><br><span class="line">        <span class="keyword">if</span>(tc_-&gt;<span class="built_in">computeVelocityCommands</span>(cmd_vel))&#123;...</span><br><span class="line">      <span class="comment">//we&#x27;ll try to clear out space with any user-provided recovery behaviors</span></span><br><span class="line">      <span class="keyword">case</span> CLEARING:</span><br><span class="line">        ...</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>这段程序多数时间运行在switch代码块里，它主要帮我们<font color='red'>计算并发布小车的控制命令</font>。不出意外的话，小车一般运行在CONTROLLING状态，所以问题主要出在CONTROLLING case下的这句代码。</p><blockquote><p>tc_-&gt;computeVelocityCommands(cmd_vel)</p></blockquote><p>有关tc_这个指针的定义写在move_base的include目录下的move_base.h文件里</p><blockquote><p>boost::shared_ptr&lt;nav_core::BaseLocalPlanner&gt; tc_;</p></blockquote><p>创建tc_指针实例的代码如下：</p><blockquote><p>tc_ &#x3D; blp_loader_.createInstance(local_planner);</p></blockquote><p>显然它是用来存放LocalPlanner的入口地址，来调用LocalPlanner方法的。LocalPlanner有多种选择，但逻辑应该都差不多，以我们用的teb_local_planner为例来看下问题。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">TebLocalPlannerROS::computeVelocityCommands</span><span class="params">(geometry_msgs::Twist&amp; cmd_vel)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="type">uint32_t</span> outcome = <span class="built_in">computeVelocityCommands</span>(dummy_pose, dummy_velocity, cmd_vel_stamped, dummy_message);</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进到computeVelocityCommands()函数里可以发现，他继续调用了传入四个参数的computeVelocityCommands()函数来完成我们需要的控制指令cmd_vel的计算。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">uint32_t</span> <span class="title">TebLocalPlannerROS::computeVelocityCommands</span><span class="params">(<span class="type">const</span> geometry_msgs::PoseStamped&amp; pose,<span class="type">const</span> geometry_msgs::TwistStamped&amp; velocity,geometry_msgs::TwistStamped &amp;cmd_vel,std::string &amp;message)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// Update obstacle container with costmap information or polygons provided by a costmap_converter plugin</span></span><br><span class="line">  <span class="keyword">if</span> (costmap_converter_)</span><br><span class="line">    <span class="built_in">updateObstacleContainerWithCostmapConverter</span>();</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">updateObstacleContainerWithCostmap</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// also consider custom obstacles (must be called after other updates, since the container is not cleared)</span></span><br><span class="line">  <span class="built_in">updateObstacleContainerWithCustomObstacles</span>();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Now perform the actual planning</span></span><br><span class="line">  <span class="type">bool</span> success = planner_-&gt;<span class="built_in">plan</span>(transformed_plan, &amp;robot_vel_, cfg_.goal_tolerance.free_goal_vel);</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">// Get the velocity command for this sampling interval</span></span><br><span class="line">  <span class="keyword">if</span> (!planner_-&gt;<span class="built_in">getVelocityCommand</span>(cmd_vel.twist.linear.x, cmd_vel.twist.linear.y, cmd_vel.twist.angular.z, cfg_.trajectory.control_look_ahead_poses))&#123;...</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个函数做的工作挺多，但许多工作计算量其实并不大，如检查插件初始化、是否到终点、获取机器人位姿、坐标转换等等，这些都不是引发问题的关键，所以我就把他们都省略了。<br>现在可以比较清晰地了解这个函数的作用，<font color="red">先更新局部代价地图上的障碍物信息，在此基础上规划出一条局部路径，然后提取速度指令。</font><br>所以很明显问题出在局部代价地图的更新上。一方面遍历障碍物对它们每个做处理，本身工作量就不少；另一方面他还涉及costmap的获取，地图给到不及时他就没法往下规划了。</p><h1 id="解决措施"><a href="#解决措施" class="headerlink" title="解决措施"></a>解决措施</h1><p>最经济的方式，在&#x2F;Path&#x2F;To&#x2F;Your&#x2F;config目录下，将local_costmap_params.yaml这个文件里的<font color='red'>width和height这两个参数调小，resolution这个参数调大</font>即可。</p>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C/C++ </tag>
            
            <tag> ROS </tag>
            
            <tag> Autonomous Driving </tag>
            
            <tag> Motion Planning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我，北京，故宫</title>
      <link href="/posts/8794/"/>
      <url>/posts/8794/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="初见"><a href="#初见" class="headerlink" title="初见"></a>初见</h1><p>年轻的人们，热情地向我，介绍着他们，与这座城市。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJN8Et.md.jpg" alt="心"></p><p>这是我对北京的第一印象，他们真的说了很多，但我似乎有点听不过来。</p><h1 id="故宫"><a href="#故宫" class="headerlink" title="故宫"></a>故宫</h1><p>我想我应该看看，所以我去了静静的，已经过去很久远的故宫。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJNVN6.md.jpg" alt="太和殿"></p><p>不过这好像也是他们跟我说的，一定要去故宫转转。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJNZ4K.md.jpg" alt="天安门"></p><p>进场总是这里，世界人民大团结，一切都是那么地美好。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJNn3D.md.jpg" alt="养性斋"></p><p><img src="https://s1.ax1x.com/2022/03/24/qJsVUJ.md.jpg" alt="太极殿"></p><p>进来发现，这里砖瓦很多，色彩在建筑上的表现是最为丰富的，尤其在过渡区：楼层与楼层、楼层与屋顶。重复与对称似乎是色彩的骨架，填充起了这些过渡区。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJNm9O.md.jpg" alt="顶"></p><p>最夸张的莫过于这个穹顶了，一度让我联想到米开朗琪罗在西斯廷教堂上的壁画。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJNKjH.md.jpg" alt="延禧宫"></p><p>延禧宫，中西结合的风格，甚是喜欢这里，着实漂亮的设计。</p><h1 id="北京"><a href="#北京" class="headerlink" title="北京"></a>北京</h1><p>不知道是不是故宫东西太多了，我看得有些累了。</p><p><img src="https://s1.ax1x.com/2022/03/24/qJN1HI.md.jpg" alt="墙"></p><p>我想我该回去听听北京的故事了。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于opencv-python的一点使用说明</title>
      <link href="/posts/5699/"/>
      <url>/posts/5699/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="关于本文"><a href="#关于本文" class="headerlink" title="关于本文"></a>关于本文</h1><ol><li>why opencv？<br>牛逼好玩</li><li>why python？<br>简单好用</li></ol><h1 id="关于安装"><a href="#关于安装" class="headerlink" title="关于安装"></a>关于安装</h1><p>为避免各种意外，使用pip安装opencv时，键入安装命令如下，信任并使用国内镜像源</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install opencv-python -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host mirrors.aliyun.com</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 环境搭建 </tag>
            
            <tag> Python </tag>
            
            <tag> opencv </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>原子会说话</title>
      <link href="/posts/53430/"/>
      <url>/posts/53430/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="关于原子"><a href="#关于原子" class="headerlink" title="关于原子"></a>关于原子</h1><p>想必你也听说过这句话</p><blockquote><p>原子一直在做无规则运动。</p></blockquote><p>他这样不知疲倦地运动，肯定是想跟我们说些什么。</p><h1 id="打印特性"><a href="#打印特性" class="headerlink" title="打印特性"></a>打印特性</h1><p>从他运动的结果来看：他其实一直在打印出东西，虽然是在乱打印，不过有意思的是，它竟然打印出了这五彩斑斓的世界。</p><p>这个观点来的有点突兀，不妨先看看下面狗狗的例子。</p><p>狗狗是我们人类最忠实的朋友，但即便如此我们依旧无法揣测狗狗的行为，它总是在活蹦乱跳。不过当两只狗狗相遇时，奇怪的事情发生了。<br>因为争抢一根骨头，他们紧密连接在了一起。</p><p><img src="https://z3.ax1x.com/2021/10/04/4ORRvd.jpg" alt="bone.jpg"></p><p>又或是因为爱情，他们也紧密连接在了一起。</p><p><img src="https://z3.ax1x.com/2021/10/04/4O6O78.jpg" alt="love.jpg"></p><p>在这些情况下狗狗的行为变得有规律可循。</p><p>原子也是如此，在特殊的情况下一些原子结合在了一起，这时候由于他们之间相互牵制，原子也就不再乱跑，而是表现出一种相对稳定的运动。在我们眼里，这种稳定的运动表现出来的就是某一物质的特性。</p><p>就这样，新的东西被打印出来了。</p><h1 id="争议"><a href="#争议" class="headerlink" title="争议"></a>争议</h1><p>认识这一特性之后，我们有了新的想法。</p><blockquote><p>我们能否控制原子的打印行为，来创造我们所想要的东西？</p></blockquote><p>这其中必然存在着一种或多种因果关系（因为某种原因导致原子行为变得有规律可循）。但在验证这个想法前，有两个关键点需要我们去思考：</p><ul><li>怎么来认识原子的行为</li><li>又如何去控制它的行为</li></ul><p>认识原子的行为是一件极其困难的事，卢瑟福的行星模型、玻尔模型、电子云模型等等又被搬上了圆桌会议，大家争论了起来，各式各样的语言、各式各样的肢体、各式各样的表情，这场面活像拉斐尔的那幅壁画——《圣体争辩》</p><p><img src="https://z3.ax1x.com/2021/11/17/I5LqVs.jpg" alt="圣体争辩.jpg"></p><p>但关于原子，其实我们一无所知。</p><h1 id="聆听"><a href="#聆听" class="headerlink" title="聆听"></a>聆听</h1><p>我们能做的，或许只是欣赏原子把这篇巨作打印出来，聆听他的故事。</p>]]></content>
      
      
      <categories>
          
          <category> 当然我在乱讲三七 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 物理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>抽象的艺术</title>
      <link href="/posts/44963/"/>
      <url>/posts/44963/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="关于此文"><a href="#关于此文" class="headerlink" title="关于此文"></a>关于此文</h1><ul><li><input disabled="" type="checkbox"> 抽象的 艺术</li><li><input checked="" disabled="" type="checkbox"> 抽象 的艺术</li></ul><h1 id="何为抽象？"><a href="#何为抽象？" class="headerlink" title="何为抽象？"></a>何为抽象？</h1><hr><p><br/><br/><br/><br>在阅读下文前，先不妨思考一会会儿，眼前这个问题。<br><br/><br/><br/></p><hr><h2 id="从无到有"><a href="#从无到有" class="headerlink" title="从无到有"></a>从无到有</h2><p>看完下图后，我确信，你对它应该有了点思绪。</p><p><img src="https://z3.ax1x.com/2021/09/09/hOuwv9.jpg" alt="马克思与人"></p><blockquote><p>  这是一个有趣的创造过程！</p></blockquote><h2 id="一种映射"><a href="#一种映射" class="headerlink" title="一种映射"></a>一种映射</h2><p>还是这张图，稍微做了点改变。<br>当然我们关注的重点还是这图左右之间的变化，不是上下两图的变化。</p><p><img src="https://z3.ax1x.com/2021/09/11/hx1wN9.jpg" alt="映射"></p><p>这里请务必将图中的两个‘抽象’区分为动词和名词（从上往下）对待。</p><blockquote><p>  映射：就像站在太阳底下，被太阳映射出来的影子保留了我们最原始的线条。</p></blockquote><h2 id="重在简化"><a href="#重在简化" class="headerlink" title="重在简化"></a>重在简化</h2><p>抽象的意义在于简化，只保留我们需要的线条就够了。</p><p><img src="https://z3.ax1x.com/2021/09/11/hxdzo6.jpg" alt="简化"><br>当然简化后我们依然能看到它大致的样子。</p><h1 id="何为艺术？"><a href="#何为艺术？" class="headerlink" title="何为艺术？"></a>何为艺术？</h1><hr><p><br/><br/><br/><br>先不妨再思考一会会儿，眼前这个问题。<br><br/><br/><br/></p><hr><h2 id="发现"><a href="#发现" class="headerlink" title="发现"></a>发现</h2><p><img src="https://z3.ax1x.com/2021/09/11/hxoyBq.png" alt="发现美"></p><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p><img src="https://z3.ax1x.com/2021/09/11/hxo6H0.png" alt="工具"></p><blockquote><p>  各类工具，综合（除上图之外的）多种方法来</p></blockquote><h2 id="创造"><a href="#创造" class="headerlink" title="创造"></a>创造</h2><p><img src="https://z3.ax1x.com/2021/09/11/hx5MVK.png" alt="创造美"></p><h1 id="所以抽象"><a href="#所以抽象" class="headerlink" title="所以抽象"></a>所以抽象</h1><ol><li>美在哪？</li></ol><ul><li><input checked="" disabled="" type="checkbox"> 简化</li></ul><ol start="2"><li>如何使用工具？</li></ol><ul><li><input checked="" disabled="" type="checkbox"> 去建立映射</li></ul><blockquote><p>  这其中包含了两个创造过程，有时你会发现某些不太美的抽象的东西，可能它只包含了一个。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 当然我在乱讲三七 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 哲学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Arduino nano的北斗定位火灾报警系统设计</title>
      <link href="/posts/6985/"/>
      <url>/posts/6985/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="设计目标"><a href="#设计目标" class="headerlink" title="设计目标"></a>设计目标</h1><p>以一个情景来说，当发生火灾时，本系统会检测到火灾，然后通过GSM通信模块，将定位和火警信息以短信形式发送给目标手机，并控制蜂鸣器实现报警。按下复位按键可以使系统重新工作在监测状态。<a href="./#%E6%9C%80%E7%BB%88%E5%AE%9E%E7%8E%B0">(点此查看效果)</a></p><h1 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h1><p>长文，有点啰嗦，但几乎涵盖所有可能会遇到的问题，望读者有所准备。不过内容简单，请放心阅读。</p><h2 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h2><table><thead><tr><th>元件清单</th><th>简介</th></tr></thead><tbody><tr><td>Arduino nano主控板，1块</td><td>作为系统主控制器</td></tr><tr><td>北斗定位模块，1个</td><td>本系统采用的是正点原子的ATK-1218-BD模块，带有源天线的版本，用来实现室内的定位</td></tr><tr><td>GSM通信模块，1个</td><td>本系统采用的是SIM900A模块，通过它发送报警短信，SIM800系列的好像也兼容</td></tr><tr><td>MQ-2烟雾传感器模块，1个</td><td>用来检测烟雾和可燃气体</td></tr><tr><td>火焰传感器模块，1个</td><td>通过红外线接收管来检测火焰</td></tr><tr><td>蜂鸣器模块，1个</td><td>用于报警</td></tr><tr><td>USB-TTL模块，1个</td><td>非必要，只是用于电脑调试GSM模块，最好是CP2102芯片那款</td></tr><tr><td>microUSB数据线，1根</td><td>用来供电以及给nano主控板烧录程序</td></tr><tr><td>面包板或洞洞板，1块</td><td>用于放置电路，面包板需若干杜邦线配合使用</td></tr></tbody></table><p>如果跟我一样是用洞洞板搭电路的话，还需电烙铁、焊锡、电线等工具和材料。</p><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><ol><li>Arduino IDE，开发Arduino必备的集成开发环境，官网下载地址 <a href="https://www.arduino.cc/en/software">(点此跳转)</a>，根据自己操作系统版本下载对应软件安装包即可</li><li>GNSS_Viewer，专门用来观察和设置北斗模块的软件，购买ATK-1218-BD模块时店家会提供资料，当然也可以到正点原子的资料下载中心获取，<a href="http://www.openedv.com/docs/modules/other/ATK-1218-BD.html">点此跳转</a></li><li>TinyGPS++库，是由Mikal Hart开发的Arduino第三方库，用来解析北斗模块发来的定位信息。这是<a href="http://arduiniana.org/libraries/tinygpsplus/">作者主页</a>，里面有下载地址还有对这个库的详细介绍。我用的1.0.2版本的库，<a href="https://pan.baidu.com/s/1bsDF44LyWBkaGKR6hcozZw">百度网盘地址</a>，提取码: q5bn，如果不知道库怎么用那就下我这个老版本吧。库的安装比较容易这里就不赘述了。</li></ol><h1 id="设计阶段"><a href="#设计阶段" class="headerlink" title="设计阶段"></a>设计阶段</h1><h2 id="管脚接线"><a href="#管脚接线" class="headerlink" title="管脚接线"></a>管脚接线</h2><p>下表展示了Arduino nano与各模块的连接关系。</p><table><thead><tr><th>Arduino nano引脚</th><th>作用</th><th>接法</th></tr></thead><tbody><tr><td>D2</td><td>普通数字输出口</td><td>接蜂鸣器I&#x2F;O引脚</td></tr><tr><td>D8</td><td>软串口1的RX</td><td>接北斗模块TX引脚</td></tr><tr><td>D9</td><td>软串口1的TX</td><td>接北斗模块RX引脚</td></tr><tr><td>D10</td><td>软串口2的RX</td><td>接GSM模块TX引脚</td></tr><tr><td>D11</td><td>软串口2的TX</td><td>接GSM模块RX引脚</td></tr><tr><td>A0</td><td>普通模拟输入口</td><td>接火焰传感器AO引脚</td></tr><tr><td>A1</td><td>普通模拟输入口</td><td>接烟雾传感器AO引脚</td></tr></tbody></table><h2 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h2><p>用AD画的，点开图片可以看得清晰点，内容跟上面其实差不多，就是看起来生动一点。</p><p><img src="https://z3.ax1x.com/2021/06/30/RwLxud.png" alt="alt原理图"></p><p>报警解除电路可以忽略，实际上它是通过Arduino nano内部的复位电路实现的，只不过现在把它画到外面了。蜂鸣器电路偷懒用了之前画的，不过不影响。</p><h2 id="程序流程图"><a href="#程序流程图" class="headerlink" title="程序流程图"></a>程序流程图</h2><p>最底下的报警解除按键实际上是通过硬件电路实现的，就是nano本身自带的复位电路。把它画在程序流程图里只是为了说明蜂鸣器报警程序虽然是死循环但是可以通过复位解除。</p><p><img src="https://z3.ax1x.com/2021/06/30/RwLjjH.png" alt="alt程序流程图"></p><h1 id="调试阶段"><a href="#调试阶段" class="headerlink" title="调试阶段"></a>调试阶段</h1><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol><li>GSM模块需要5V2A的电源供电，否则模块工作可能不正常；</li><li>单独调试GSM模块跟电脑串口通信时需要质量较好的USB转TTL模块，我用自己之前买的劣质CH340芯片的USB转TTL模块在调试时失败了，电脑串口能识别但是发AT指令给GSM模块没反应，换了CP21202芯片的USB转TTL模块就好了；</li><li>北斗定位模块的有源天线最好放到阳台外，这样才能搜到卫星；</li><li>虽然Arduino nano软串口支持的最高波特率是115200，但测试时发现，只有波特率工作在9600才正常，这也是为什么下面把北斗模块波特率也设成9600的原因；</li><li>北斗模块每次使用前需要用GNSS_Viewer软件对它的波特率修改为9600（这个可能是我的北斗模块有问题，没法把设置写进flash）；</li><li>烟雾传感器使用前需要预热几分钟，具体多久看串口，打印的数值不咋跳了，就预热完了；</li><li>火焰传感器对光是敏感的，也就是说中午太阳光很亮的话，它也会触发，这也是为什么加烟雾传感器的原因。</li></ol><h2 id="火焰、烟雾传感器"><a href="#火焰、烟雾传感器" class="headerlink" title="火焰、烟雾传感器"></a>火焰、烟雾传感器</h2><p>这两模块均可通过以下代码测试好坏，检测到火焰或烟雾后，串口打印的数值会发生较大变化。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> flameSensor A0 <span class="comment">//火焰传感器</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> smogSensor  A1 <span class="comment">//烟雾传感器</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(flameSensor,<span class="literal">INPUT</span>);    </span><br><span class="line">  <span class="comment">//pinMode(smogSensor,INPUT);  </span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);   <span class="comment">//初始化串口，便于调试</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//每秒打印传感器检测值（数值范围为0-1023）</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="built_in">analogRead</span>(flameSensor));</span><br><span class="line">  <span class="comment">//Serial.println(analogRead(flameSensor));</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个参考：我的火焰传感器在晚上测出来数值在1015-1017徘徊，拿手机闪光灯照射数值会降到850以下；烟雾传感器正常值应该在500以下，检测到烟雾数值会超过500，当时测得应该67百这样。<br>以上仅是参考，实际上每个传感器检测的返回值各不相同，只要检测到火焰或烟雾时，数值上有较大的变动即可说明模块工作正常。</p><h2 id="SIM900A通信模块"><a href="#SIM900A通信模块" class="headerlink" title="SIM900A通信模块"></a>SIM900A通信模块</h2><ol><li>插入手机卡后，与USB转TTL模块（按TXD-RXD、RXD-TXD、GND-GND连接）好后，供上5V2A的电，不出意外的话，模块已经正常工作了。</li><li>可以给模块上的手机号打电话，正常拨通振铃的话说明模块应该没问题。然后就可以把USB转TTL模块接到电脑上，打开串口助手，设置通信参数（波特率9600，数据位8，停止位1），然后打开对应的串口，发送指令‘AT’，如果收到模块的回复‘OK’，那就说明电脑与模块串口通信正常。</li><li>然后就可以通过以下程序烧录到单片机，测试单片机与GSM模块的串口通信是否正常。</li></ol><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">SIM900A</span><span class="params">(<span class="number">10</span>,<span class="number">11</span>)</span></span>; <span class="comment">//GSM模块串口</span></span><br><span class="line"><span class="type">String</span> msg=<span class="string">&quot;Hello!&quot;</span>;   <span class="comment">//短息的内容</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sendMeg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(<span class="string">&quot;AT&quot;</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(F<span class="string">&quot;AT+CMG=1&quot;</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(<span class="string">&quot;AT+CMGS=\&quot;13xxxxxxxx2\&quot;&quot;</span>); <span class="comment">//填接收短信的号码</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(msg);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(<span class="string">&quot;\r\n&quot;</span>);  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">write</span>(<span class="number">0x1A</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SIM900A.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="built_in">sendMeg</span>();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果程序中的手机号码收到了对应短信内容，说明模块工作正常，测试完成。</p><h2 id="北斗模块"><a href="#北斗模块" class="headerlink" title="北斗模块"></a>北斗模块</h2><p>跟GSM一样与USB转TTL模块连接好后，可以通过GNSS_Viewer软件查看模块是否定位成功，我的北斗模块通信波特率默认是115200，所以定位成功后需设置波特率为9600。<br>然后就可以通过TinyGPS++自带的例程测试本模块，该例程在正常安装好TinyGPS++库后，应该能在Arduino IDE的菜单栏（File-&gt;Examples-&gt;TinyGPS++）里找到。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TinyGPS++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">TinyGPSPlus gps;</span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">ss</span><span class="params">(<span class="number">8</span>,<span class="number">9</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> latitude;</span><br><span class="line"><span class="type">float</span> longitude;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>); <span class="comment">//set the baud rate of serial port to 9600;</span></span><br><span class="line">  ss.<span class="built_in">begin</span>(<span class="number">9600</span>); <span class="comment">//set the GPS baud rate to 9600;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  ss.<span class="built_in">listen</span>();</span><br><span class="line">  <span class="keyword">while</span> (ss.<span class="built_in">available</span>() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    gps.<span class="built_in">encode</span>(ss.<span class="built_in">read</span>()); <span class="comment">//The encode() method encodes the string in the encoding format specified by encoding.     </span></span><br><span class="line">    <span class="keyword">if</span> (gps.location.<span class="built_in">isUpdated</span>())&#123;</span><br><span class="line">      latitude = gps.location.<span class="built_in">lat</span>(); <span class="comment">//gps.location.lat() can export latitude</span></span><br><span class="line">      longitude = gps.location.<span class="built_in">lng</span>();<span class="comment">//gps.location.lng() can export latitude</span></span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot;Latitude=&quot;</span>);</span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">print</span>(latitude, <span class="number">6</span>);  <span class="comment">//Stable after the fifth position</span></span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">print</span>(<span class="string">&quot; Longitude=&quot;</span>);</span><br><span class="line">      <span class="built_in">Serial</span>.<span class="built_in">println</span>(longitude, <span class="number">6</span>);</span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>没问题的话，该例程会在串口打印输出经纬度信息，即说明北斗模块定位正常且该库正常解析出定位信息中的经纬度信息。</p><h2 id="蜂鸣器模块"><a href="#蜂鸣器模块" class="headerlink" title="蜂鸣器模块"></a>蜂鸣器模块</h2><p>该模块可通过下面这个程序检测。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> Buzz 2    <span class="comment">//定义蜂鸣器引脚为D2</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BuzzOnOff</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(Buzz,<span class="literal">HIGH</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(Buzz,<span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(Buzz,<span class="literal">OUTPUT</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  <span class="built_in">BuzzOnOff</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>它够吵就说明模块正常。</p><h2 id="Arduino软串口"><a href="#Arduino软串口" class="headerlink" title="Arduino软串口"></a>Arduino软串口</h2><p>因为GSM模块与北斗模块都要用串口通信，而nano仅有一个物理串口，这就需要用软件实现串口，简称软串口。关于例程在Arduino IDE的菜单栏（File-&gt;Examples-&gt;SoftwareSerial-&gt;SoftwareSerialExample）里可以找到。<br>下面是我测试软串口的程序，它将nano的D8、D9、D10、D11这四个脚模拟成两个串口，一个串口发信息，另一个串口可以收到该信息。简而言之，让Arduino自言自语，哦，准确的说，好像是我在自言自语。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">beidou</span><span class="params">(<span class="number">8</span>, <span class="number">9</span>)</span></span>; <span class="comment">// RX, TX</span></span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">gsm</span><span class="params">(<span class="number">10</span>, <span class="number">11</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  beidou.<span class="built_in">begin</span>(<span class="number">57600</span>);</span><br><span class="line">  gsm.<span class="built_in">begin</span>(<span class="number">4800</span>);</span><br><span class="line">  beidou.<span class="built_in">println</span>(<span class="string">&quot;Hi!This is beidou.&quot;</span>);</span><br><span class="line">  gsm.<span class="built_in">println</span>(<span class="string">&quot;Hello,It&#x27;s gsm&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123; </span><br><span class="line">  <span class="keyword">if</span> (beidou.<span class="built_in">available</span>()) &#123;</span><br><span class="line">    gsm.<span class="built_in">write</span>(beidou.<span class="built_in">read</span>());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (gsm.<span class="built_in">available</span>()) &#123;</span><br><span class="line">    beidou.<span class="built_in">write</span>(gsm.<span class="built_in">read</span>());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试需要两个USB转TTL模块分别（按TXD-D8、RXD-D9、GND-GND和TXD-D10、RXD-D11、GND-GND）连接，然后打开两个串口助手软件才能看到效果。没问题的话，你在一个串口助手发消息，可以在另一个串口助手收到消息。</p><h1 id="最终实现"><a href="#最终实现" class="headerlink" title="最终实现"></a>最终实现</h1><p>下面是最终测试的视频</p><iframe   height=200 width=300   src="https://player.youku.com/embed/XNTE3NTgwMDgwNA=="   frameborder="0"   allowfullscreen></iframe><p>过会儿手机就会受到火灾报警短信，如下所示。</p><p><img src="https://z3.ax1x.com/2021/06/30/RwLzDA.md.jpg" alt="alt短信"></p><h2 id="总程序"><a href="#总程序" class="headerlink" title="总程序"></a>总程序</h2><p>就60几行代码？是的，就这么点。你完全可以读懂每一行代码在做什么。</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SoftwareSerial.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;TinyGPS++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Buzz 2    <span class="comment">//定义蜂鸣器引脚为D2</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> flameSensor A0 <span class="comment">//火焰</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> smogSensor  A1 <span class="comment">//烟雾</span></span></span><br><span class="line"></span><br><span class="line">TinyGPSPlus gps;</span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">Beidou</span><span class="params">(<span class="number">8</span>,<span class="number">9</span>)</span></span>;   <span class="comment">//北斗串口RX, TX</span></span><br><span class="line"><span class="type">float</span> latitude;</span><br><span class="line"><span class="type">float</span> longitude;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">SoftwareSerial</span> <span class="title">SIM900A</span><span class="params">(<span class="number">10</span>,<span class="number">11</span>)</span></span>; <span class="comment">//GSM模块串口</span></span><br><span class="line"><span class="type">String</span> msg=<span class="string">&quot;EMERGENCY!  FIRE ALARM!!!\r\nPositioin Here: &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sendMeg</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(<span class="string">&quot;AT&quot;</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(<span class="string">&quot;AT+CMGF=1&quot;</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">println</span>(<span class="string">&quot;AT+CMGS=\&quot;12345654321\&quot;&quot;</span>); <span class="comment">//接收号码</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(msg);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(<span class="string">&quot;Latitude=&quot;</span>); <span class="comment">//发送定位信息</span></span><br><span class="line">  SIM900A.<span class="built_in">print</span>(latitude, <span class="number">6</span>); </span><br><span class="line">  SIM900A.<span class="built_in">print</span>(<span class="string">&quot;, Longitude=&quot;</span>);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(longitude, <span class="number">6</span>);</span><br><span class="line">  SIM900A.<span class="built_in">print</span>(<span class="string">&quot;\r\n&quot;</span>);  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">  SIM900A.<span class="built_in">write</span>(<span class="number">0x1A</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">BuzzOnOff</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(Buzz,<span class="literal">HIGH</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(Buzz,<span class="literal">LOW</span>);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">100</span>);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(flameSensor,<span class="literal">INPUT</span>);  </span><br><span class="line">  <span class="built_in">pinMode</span>(smogSensor,<span class="literal">INPUT</span>);   </span><br><span class="line">  <span class="built_in">pinMode</span>(Buzz,<span class="literal">OUTPUT</span>);</span><br><span class="line">  SIM900A.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  Beidou.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">  Beidou.<span class="built_in">listen</span>();</span><br><span class="line">  <span class="keyword">while</span>(Beidou.<span class="built_in">available</span>() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="comment">/*  The encode() method encodes the string in the encoding format </span></span><br><span class="line"><span class="comment">    specified by encoding.  */</span></span><br><span class="line">    gps.<span class="built_in">encode</span>(Beidou.<span class="built_in">read</span>());    </span><br><span class="line">    <span class="keyword">if</span> (gps.location.<span class="built_in">isUpdated</span>())&#123;</span><br><span class="line">      latitude = gps.location.<span class="built_in">lat</span>(); <span class="comment">//gps.location.lat() can export latitude</span></span><br><span class="line">      longitude = gps.location.<span class="built_in">lng</span>();<span class="comment">//gps.location.lng() can export latitude</span></span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">analogRead</span>(smogSensor)&gt;<span class="number">500</span> &amp;&amp; <span class="built_in">analogRead</span>(flameSensor)&lt;<span class="number">650</span>)&#123;</span><br><span class="line">      <span class="built_in">BuzzOnOff</span>();</span><br><span class="line">      <span class="built_in">sendMeg</span>();</span><br><span class="line">      <span class="keyword">while</span>(<span class="number">1</span>)&#123;<span class="built_in">BuzzOnOff</span>();&#125;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;                                         </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> C/C++ </tag>
            
            <tag> Arduino </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用555定时器加CD4017实现流水灯(Multisim仿真)</title>
      <link href="/posts/43098/"/>
      <url>/posts/43098/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="设计目标"><a href="#设计目标" class="headerlink" title="设计目标"></a>设计目标</h1><p>通过一555定时器芯片和一CD4017芯片控制9个LED灯间隔0.5s依次点亮，即实现流水灯。</p><h1 id="手动流水灯"><a href="#手动流水灯" class="headerlink" title="手动流水灯"></a>手动流水灯</h1><p>为比较形象地说明CD4017芯片的工作原理，我下面通过设计一个简单的手动流水灯的实现来介绍这个芯片。</p><h2 id="脉冲发生电路"><a href="#脉冲发生电路" class="headerlink" title="脉冲发生电路"></a>脉冲发生电路</h2><p>下图是一个非常简单的按键电路，但这里我们是用它来产生脉冲信号的。它的电路很简单，电源正负极中间接了个按键开关，串了个电阻是保护电路的。右边是双通道示波器，通道A接的按键电路的输出，用来观察它输出的电压信号。<br><img src="https://z3.ax1x.com/2021/05/07/g1NwuT.png" alt="alt按键电路"></p><p>关于它如何产生脉冲信号还有什么是上升沿信号的问题，我们看下示波器的仿真结果就好理解了。看下图，很明显在按下按键后电压从低电平变成了高电平，而右边示波器界面显示的就是一个典型的上升沿脉冲信号。<br><img src="https://z3.ax1x.com/2021/05/07/g1UoLT.png" alt="alt脉冲"></p><h2 id="CD4017流水灯"><a href="#CD4017流水灯" class="headerlink" title="CD4017流水灯"></a>CD4017流水灯</h2><p>有了脉冲发生电路，我们就可以结合CD4017芯片做一个手动的流水灯了。下面是它的电路，左边就是我们刚设计的按键电路，由它产生的脉冲信号给到了CD4017芯片的CP0输入口，右边就是流水灯电路。<br><img src="https://z3.ax1x.com/2021/05/07/g1wIyt.gif" alt="alt手动流水灯"><br>看上图，每次我开闭开关（产生上升沿信号），灯就会往后移动一盏。这就是CD4017脉冲分配和计数的原理，也是它最主要的应用了。简单来说，CP口收到一个上升沿信号，输出口移1位。</p><p>至于O9输出口为什么接MR脚，以及CD4017芯片的其他引脚的作用我等下再说。这里只是先实现一个简单的手动流水灯的设计而已。</p><h1 id="真正的流水灯"><a href="#真正的流水灯" class="headerlink" title="真正的流水灯"></a>真正的流水灯</h1><p>手动很麻烦，现在就要用555定时器来帮助我们实现自动化了。接下来就开始实现本文的设计目标了。</p><h2 id="方波信号发生器"><a href="#方波信号发生器" class="headerlink" title="方波信号发生器"></a>方波信号发生器</h2><p>通过555定时器产生我们刚通过开闭按键产生的上升沿（也叫方波)信号，即方波信号发生器。跟之前按键电路的区别在于，它会隔段时间就输出同样的上升沿信号,不用再人为地开闭按键，从而实现了自动化。</p><p>那它是怎么工作的呢？简单来说，它就是靠电容充放电产生的方波，电容充电时它输出高电平，放电时输出低电平，所以电容越大，充放电时间越久，周期也就越大。</p><p>下面是它的电路，通过对电容C1值的修改可以改变输出方波信号的周期，对电位器R12的修改可以改变方波信号的占空比。这两者的参数都可以决定最后我们设计的流水灯的显示时间间隔。<br><img src="https://z3.ax1x.com/2021/05/07/g1ggT1.png" alt="alt555方波发生电路"><br>对于555定时器做方波信号发生器的应用，我觉得了解以上内容即可自行设计了。然后，对它的原理感兴趣的话可以在这里<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="阎石的《数字电子技术基础》(第六版)，第七章，7.5节-555定时器及其应用，第380页公式（7.5.4）有涉及到周期的计算。">[1]</span></a></sup>找到答案。</p><h2 id="示波器的使用"><a href="#示波器的使用" class="headerlink" title="示波器的使用"></a>示波器的使用</h2><p>本文要设计间隔0.5s亮灭的流水灯，那么输出方波的周期就应该是0.5s，为得到合适的输出周期，我们还得会用示波器方便看波形。</p><p>打开仿真，示波器开始输出波形，横轴代表时间(也叫周期)，纵轴代表输出电压(也叫幅值)。波形图的下方显示的是仿真运行的时间还有A通道的幅值电压。再往下就是对波形图的设置，Timebase(时基)栏下的Scale(比例)框可以修改时间轴一格的单位(这里每格代表200ms)，Channel A(通道A)栏下的Scale框可以修改电压幅值轴一格的单位(这里每格代表2V)。<br><img src="https://z3.ax1x.com/2021/05/07/g1Wmw9.png" alt="alt示波器"><br>从上图两个下降沿可以判断出现在方波输出周期差不多是480ms，跟我们要求的500ms，仅20ms的误差，差不多可以接受了。</p><h1 id="仿真实现"><a href="#仿真实现" class="headerlink" title="仿真实现"></a>仿真实现</h1><p>方波输出合适了，现在就可以直接把方波产生电路的输出接到CD4017控制的流水灯电路上了。因为本次设计需要有实物，考虑到器件不好找的问题所以就把2.2uF的电容通过两个1uF的电容并联等效了。下图即为最终设计的电路。<br><img src="https://z3.ax1x.com/2021/05/27/2PXskd.png" alt="alt流水灯电路"><br>现在结合上图说下为啥要把O9输出接到MR脚吧，CD4017的MR脚应该代表Master Reset，就是主复位清零的意思。当在MR脚加高电平或正脉冲时，计数器清零，在所有输出中，只有对应“0”状态的O0输出高电平，其余输出均为低电平。</p><p>因为本设计目标只要9个流水灯，O9这个输出我们没有用到的，所以最好就是它输出高电平时马上跳回到O0(也即回到第一盏LED灯)，这里就是利用了MR脚的这个工作特性，提前让CD4017重新开始计数了。</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">阎石的《数字电子技术基础》(第六版)，第七章，7.5节-555定时器及其应用，第380页公式（7.5.4）有涉及到周期的计算。<a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数电 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/37904/"/>
      <url>/posts/37904/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Hi"><a href="#Hi" class="headerlink" title="Hi"></a>Hi</h1><center>偶尔想起来了什么,这里就会多点东西</center><h2 id="太阳"><a href="#太阳" class="headerlink" title="太阳"></a>太阳</h2><p> 每个人都是那么闪耀<br> 如同一片星海<br> 而太阳，与其说它照亮了万物<br> 倒不如说它遮住了星空<br> 但是人吧，不得不向前看<br> 所以也就少有抬头看的机会<br> 不过终有一天<br> 星星会铺满这片天空</p><p align="right">3.12.2021</p><h2 id="外婆"><a href="#外婆" class="headerlink" title="外婆"></a>外婆</h2><p>昨天的这个时候<br>你突然邀请我<br>观看这场烟与火的表演<br>秸秆燃烧的味道<br>跟小时候一模一样<br>也许在你眼中<br>我还是一个孩子模样<br>多么希望被子里塞的是枕头<br>而你躲在床底下偷着乐<br>这一切都只是你的一个恶作剧</p><p align="right">1.8.2022</p>]]></content>
      
      
      <categories>
          
          <category> 当然我在乱讲三七 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手把手用阿里云ECS搭建Minecraft服务器</title>
      <link href="/posts/42242/"/>
      <url>/posts/42242/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我的世界这个游戏还挺好玩的，所以就搭个服务器跟好朋友一起玩呗。本文虽然写的是阿里云ECS<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="Elastic Compute Service(弹性计算服务)，其实就是一台24小时开机，能上网的电脑">[1]</span></a></sup>，不过腾讯云还有其他云服务商的云机也是可以的。</p><h1 id="准备阶段"><a href="#准备阶段" class="headerlink" title="准备阶段"></a>准备阶段</h1><h2 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h2><ol><li>一台能上网的电脑(下面会用‘客户端’引用它)</li><li>一台内存至少2G的ECS(下面会用‘服务端’引用它)，可以直接到云服务商那直接购买(较贵)，也可以选择下面的获取途径:</li></ol><table><thead><tr><th>要求</th><th>途径及介绍</th></tr></thead><tbody><tr><td>阿里云新人</td><td>新人试用福利，可以免费领一台服务器，试用一个月<a href="https://free.aliyun.com/?spm=5176.12482766.J_9220772140.52.60404c27E6WBQm">(传送门)</a></td></tr><tr><td>学生，年龄24岁以下</td><td>阿里云学生计划，可免费领两个月2核4G的服务器，但是得看运气，领完就没了。到期有测验过了还能免费续4个月，总共6个月，挺好的一个福利<a href="https://developer.aliyun.com/adc/student/?spm=a2c6h.20842984.J_3574106040.1.7e3630998Tmeor">(传送门)</a></td></tr><tr><td>同上</td><td>开发者成长计划，选择学生专享那款，9.5元每月挺实惠的<a href="https://developer.aliyun.com/plan/promotion/1?spm=a2c6h.13788107.1364563.d100010001.755150a3HNFywi&utm_content=g_1000199894">(传送门)</a></td></tr><tr><td>undefined</td><td>万能的淘宝，不多介绍</td></tr></tbody></table><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><p>客户端用的是win10操作系统，服务端选的是centos8.0操作系统。其他操作系统也是一个原理，下载对应版本的软件即可。除了服务端的JDK1.8.0和screen，其他的软件都先下载到客户端上。</p><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><ol><li>FileZilla，一款免费提供FTP解决方案的软件，靠它把文件传到服务端。<a href="https://filezilla-project.org/download.php?type=client">官网下载地址</a>，下完直接打开，默认安装即可。</li><li>PuTTY，一款Windows和Unix平台的SSH和Telnet免费实现的软件，靠它操作服务端。<br><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">官网下载地址</a>，下完安装。</li><li>JRE1.8.0<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="Java SE Runtime Environment 8，简称JRE8，Java的运行环境。MC是用Java写的，所以得靠它运行MC，它起的是翻译代码的作用。">[2]</span></a></sup>，用来测试MC，没有它跑不了游戏。<a href="https://www.oracle.com/java/technologies/javase-jre8-downloads.html">官网下载地址</a>，下完安装。</li><li>MC客户端，图方便你可以选择跟我一样的客户端。<a href="https://pan.baidu.com/s/1JSC-R9Yvby5UzCo6cCltng">百度网盘地址</a> 提取码：om9q</li></ol><p>如果你不喜欢这个花里胡哨的，也可以去mcbbs(我的世界论坛)服务端板块去找其他的整合包(带客户端的就行),我也是这里找的。</p><blockquote><p>附上原帖地址：<a href="https://www.mcbbs.net/thread-1062266-1-1.html">https://www.mcbbs.net/thread-1062266-1-1.html</a></p></blockquote><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><ol><li>JDK1.8.0<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="Java Development Kit，是用来开发Java的工具包，这里是给MC提供运行环境。">[3]</span></a></sup>，作用同客户端的JRE1.8.0。</li><li>screen，linux系统上必装神器。</li><li>MC服务端。<a href="https://pan.baidu.com/s/1xErKNifOqynrSZL_-cYdWw">百度网盘地址</a> 提取码：ycnj</li></ol><h1 id="部署阶段"><a href="#部署阶段" class="headerlink" title="部署阶段"></a>部署阶段</h1><p>到这一步时确定MC客户端和服务端都已经都下载了，并且FileZilla，PuTTY，JRE1.8.0已安装在你的PC上。服务端也已经安装好系统。</p><h2 id="客户端-1"><a href="#客户端-1" class="headerlink" title="客户端"></a>客户端</h2><ol><li>首先，把MC服务端和客户端解压到一个文件夹，位置随意(只要自己找的到就行)。</li><li>打开FileZilla软件，按下图填写内容，填完后点击快速连接即可。</li></ol><p><img src="https://s3.ax1x.com/2020/12/10/risqaQ.png" alt="altFileZilla的使用">注：公网ip在阿里云官网进入云服务器ECS控制台就能看到，如下图所示：<br><img src="https://s3.ax1x.com/2020/12/10/risbVg.png" alt="alt查看公网ip">还有不知道root密码的话按下图操作重置密码即可：<br><img src="https://s3.ax1x.com/2020/12/10/riyprT.png" alt="alt重置实例密码"></p><ol start="3"><li>连接到服务器后，把服务端的解压文件拷贝到服务器上。这是FileZilla软件的基操，如下图所示：</li></ol><p><img src="https://s3.ax1x.com/2020/12/10/risL5j.png" alt="altfilezilla的简单操作"><br>4.  接下来打开Putty软件，连接服务器，按下图操作：</p><p><img src="https://s3.ax1x.com/2020/12/10/risv2q.png" alt="altPutty的使用"></p><ol start="5"><li>第一次连接会有对话框提示选接受，然后输入你的用户名回车，会提示你输密码，输入密码回车，就进入服务器后台了。没问题的话应该是下图这个样子。</li></ol><p><img src="https://s3.ax1x.com/2020/12/10/risjGn.png" alt="altputty登陆界面"></p><h2 id="服务端-1"><a href="#服务端-1" class="headerlink" title="服务端"></a>服务端</h2><ol><li>JDK1.8.0的安装，安装前可以用下面的命令测试下系统有没有安装java，有的话就不用重复安装了。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure>安装过的会显示如下信息：<br><img src="https://s3.ax1x.com/2020/12/10/ris7qS.png" alt="altJava版本信息">没安装的话，输入下面的命令安装。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install java-1.8.0-openjdk* -y</span><br></pre></td></tr></table></figure></li><li>screen的安装及使用，先输入下面的命令安装screen<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install screen -y</span><br></pre></td></tr></table></figure>然后输入下面的命令创建一个名叫mc的会话<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen -S mc</span><br></pre></td></tr></table></figure></li><li>接下来都是在这个会话窗口操作，cd命令进入游戏文件夹，vim命令查看修改server.properties(MC服务器配置文件)。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/mc</span><br><span class="line">vim server.propertiesimages</span><br></pre></td></tr></table></figure></li><li>接下来进入的是vim编辑界面，这里不要乱按键。按我下面写的一步步走。<br>先输入<kbd>i</kbd>进入插入模式，编辑界面的左下角应该是跟我一样的，如下图：<br><img src="https://s3.ax1x.com/2020/12/10/riy9qU.png" alt="altvim操作">然后就可以编辑配置文件了，主要注意下面这几个参数：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">difficulty=hard   <span class="comment">#这个参数设置游戏难度，hard是困难，可以改成normal普通</span></span><br><span class="line">gamemode=survival <span class="comment">#设置游戏模式，survival是生存模式</span></span><br><span class="line">max-players=20    <span class="comment">#这里设置最大玩家数量，默认20个玩家</span></span><br><span class="line">online-mode=<span class="literal">false</span> <span class="comment">#这个参数一定要改成false否则玩家加不进来</span></span><br><span class="line">server-port=25565 <span class="comment">#游戏端口，这个得记住</span></span><br></pre></td></tr></table></figure></li><li>修改完按<kbd>ECS</kbd>，再按<kbd>shift</kbd>+<kbd>；</kbd>，最后输入<kbd>wq</kbd>保存并退出。</li><li>iptables命令开启25565端口(上面配置文件里的游戏端口)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 25565 -j ACCEPT  <span class="comment">#--dport后面可以改端口</span></span><br></pre></td></tr></table></figure></li><li>配置安全组规则<br>重新打开阿里云的ECS控制台，选择对应的实例，选中安全组，添加一条如下的规则：<br><img src="https://s3.ax1x.com/2020/12/10/riySMV.png" alt="alt安全组规则配置"></li><li>启动游戏</li></ol><ul><li>方式一，4G的服务器可以把下面命令里的Xmx2000M改成Xmx4000M，命令如下：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -Xmx2000M -Xms1024M -jar forge.jar nogui</span><br></pre></td></tr></table></figure></li><li>方式二，把上面的命令写进脚本文件，命令如下：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;java -Xmx2000M -Xms1024M -jar forge.jar nogui&quot;</span> &gt; start.sh</span><br><span class="line"><span class="built_in">chmod</span> 777 start.sh    <span class="comment"># 再用chmod命令修改文件权限，让start.sh文件可以执行</span></span><br></pre></td></tr></table></figure>以后只要执行这个脚本就能启动MC服务器了：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./start.sh </span><br></pre></td></tr></table></figure></li></ul><ol start="9"><li>游戏启动时会一直弹东西不用慌，过个2分钟不到就差不多了。输入&#x2F;help跳出一连串的命令就说明服务器成功启动了，类似我的结果：<br><img src="https://s3.ax1x.com/2020/12/10/risTr8.png" alt="altMC成功启动"><br>然后按<kbd>ctrl</kbd>+<kbd>A</kbd>+<kbd>D</kbd>可以剥离会话。放心MC服务端不会停，它会一直在mc这个会话窗口里运行。<br>想重新进入会话的话，输入下面命令即可<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen -x mc  <span class="comment">#-x 后面跟会话名</span></span><br></pre></td></tr></table></figure>忘记会话名的话可以用下面的命令查看<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">screen -<span class="built_in">ls</span></span><br></pre></td></tr></table></figure></li><li>screen的用法就这些。退出会话后，接着直接关掉putty窗口就行了，服务端已经部署完了。</li></ol><h1 id="测试阶段"><a href="#测试阶段" class="headerlink" title="测试阶段"></a>测试阶段</h1><p>回到你的PC机，打开游戏客户端的解压文件，双击HMCL-3.3.172.exe文件，游戏就打开了。HCML是一款MC的启动器，用法不多介绍了。<br>创建一个用户直接开始游戏。<br>选择多人游戏，在下面点击添加服务器，把你的服务器公网ip填到服务器地址那栏，服务器名称随意。填完点完成。成功的话应该能看到下图：</p><p><img src="https://s3.ax1x.com/2020/12/10/risXPs.png" alt="altMC运行"><br>点击加入服务器开始畅玩吧！游戏截图：</p><p><img src="https://s3.ax1x.com/2020/12/10/risxx0.png" alt="alt开服截图"></p><p>如果有什么问题的话可以在文章下面评论留言，也可以点击下面的联系方式发邮件给我。</p><h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Elastic Compute Service(弹性计算服务)，其实就是一台24小时开机，能上网的电脑<a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Java SE Runtime Environment 8，简称JRE8，Java的运行环境。MC是用Java写的，所以得靠它运行MC，它起的是翻译代码的作用。<a href="#fnref:2" rev="footnote"> ↩</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Java Development Kit，是用来开发Java的工具包，这里是给MC提供运行环境。<a href="#fnref:3" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
      
      
      <categories>
          
          <category> 实用教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第六天</title>
      <link href="/posts/14964/"/>
      <url>/posts/14964/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="最后一天"><a href="#最后一天" class="headerlink" title="最后一天"></a>最后一天</h1><p>真快，到最后一天了，目的地是最初的起点-西海镇。今天最大的挑战是5公里的缓上坡。</p><p>在国道上骑行总是遇到鬼天气，今天又是阴雨天赶路的一天，配合上坡路真的够折磨的，一路上都没怎么拍照。</p><p>离开了哈尔盖，就真的离开了刚察，路边也看不到大片的油菜花了。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1E6Ts.md.jpg" alt="alt离开刚察"></p><h1 id="甘子河"><a href="#甘子河" class="headerlink" title="甘子河"></a>甘子河</h1><p>中途经过了甘子河乡，门口雕像很有牌面，像在欢迎旅人。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1E779.md.jpg" alt="alt甘子河乡"></p><h1 id="绝望坡"><a href="#绝望坡" class="headerlink" title="绝望坡"></a>绝望坡</h1><p>不知不觉中居然登上绝望坡了，说起来这一路好像确实下来推了有好长一段路的车，但没想到5公里长的缓上坡就这样骑完了。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1EXp6.md.jpg" alt="alt绝望坡"></p><p>看到这五彩经幡，感觉自己已经快完成今天的目标了，接下来的体验更是印证了我的感觉。</p><p>这是极为离谱的长下坡，有多离谱呢？事后，我的衣服后面是黑色的一条印记，要知道我的车是有挡泥板的。</p><p>印象中这个下坡经过了两个小山坡，就这样滑了有好几公里，太爽了。下完坡后就看到了西海镇，第一天跟HS一起试车的路也逐渐让我熟悉了起来，没错，我们的终点要到了。</p><h1 id="完结"><a href="#完结" class="headerlink" title="完结"></a>完结</h1><p>真快，下午1点半大家就回到了5天前的起点，这一路共计360公里，用了4天半时间骑完了。</p><p>有点懵，真的不可思议，就骑完了。值得高兴的是，大伙都安全骑到了，而且就我没扎过胎😄。今日的骑行记录如下：</p><p><img src="https://s3.ax1x.com/2020/12/17/rGaRr8.md.jpg" alt="alt记录"></p><p>再见了，青海湖！再见了，这里的人！再见了，这一路的骑友！</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第五天</title>
      <link href="/posts/29293/"/>
      <url>/posts/29293/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="行程安排"><a href="#行程安排" class="headerlink" title="行程安排"></a>行程安排</h1><p>今日的行程很轻松，只有50多公里，不过上坡路挺多。从泉吉出发至哈尔盖，途径刚察，一路过来难得一遇的县城，心中对此充满了期待。</p><h1 id="出发"><a href="#出发" class="headerlink" title="出发"></a>出发</h1><p>从环湖西路骑到国道315后天气又变得奇怪了起来，一早看到灰蒙蒙的天还是有点担心。吃饭前，阿潘同学发现他的车胎没气了。饭后补完胎，我们出发了。</p><p>沿路的生态-健硕的草地，看不到青海湖了，铁路依旧。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1m39I.md.jpg" alt="alt铁路"></p><p>不知骑了多久，路上出现了大片的油菜花，如同骑在花海中。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1Eywj.md.jpg" alt="alt油菜花1"></p><p>就是在这花海中，远远的可以望见刚察了，结果HS的车又扎胎了，不过这次我正好在旁边，工具包也在。不过这破洞还真够难找的，折腾了半天我们决定先打点气去县城里补了。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1EB6S.md.jpg" alt="alt油菜花2"></p><h1 id="鱼鸟天堂，藏城刚察"><a href="#鱼鸟天堂，藏城刚察" class="headerlink" title="鱼鸟天堂，藏城刚察"></a>鱼鸟天堂，藏城刚察</h1><p>到刚察了，好快。一个草原城市的面貌逐渐清晰了起来。还有个别名：高原滨海藏城。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1E0l8.md.jpg" alt="alt刚察1"></p><p>进城了，神秘的藏族文化扑面而来。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1V5Ct.md.jpg" alt="alt刚察2"></p><center>休息椅</center><hr><p><img src="https://s3.ax1x.com/2020/12/16/r1VxCq.md.jpg" alt="alt刚察3"></p><center>三种文字的指示牌</center><hr><p><img src="https://s3.ax1x.com/2020/12/16/r1EwSf.md.jpg" alt="alt刚察4"></p><center>藏城刚察</center><hr><p>在藏城吃过饭补完胎后，我们又出发了。</p><h1 id="神奇的塔"><a href="#神奇的塔" class="headerlink" title="神奇的塔"></a>神奇的塔</h1><p>远远的一双眼睛很迷人，走近一看，胸口贴着“党的恩情深似海”。</p><blockquote><p>  想到一句话：Big brother is watching you</p></blockquote><p><img src="https://s3.ax1x.com/2020/12/16/r1VVc8.md.jpg" alt="alt刚察5"><br><img src="https://s3.ax1x.com/2020/12/16/r1Vu7j.md.jpg" alt="alt刚察6"></p><h1 id="再见，藏城"><a href="#再见，藏城" class="headerlink" title="再见，藏城"></a>再见，藏城</h1><p>城边公园，山坡绿地上摆着一串神秘的藏文。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1ET0J.md.jpg" alt="alt刚察7"></p><p>站在县城门口的两座塔像是在守护这座城市。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1Eom4.md.jpg" alt="alt刚察8"></p><p>城边的山顶上挂满了五色彩旗。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1EhlT.md.jpg" alt="alt刚察9"></p><p>出城后又是一路的油菜。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1E46U.md.jpg" alt="alt油菜"></p><h1 id="哈尔盖"><a href="#哈尔盖" class="headerlink" title="哈尔盖"></a>哈尔盖</h1><p>很快，到了我们今天的目的地，哈尔盖。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1EfpV.md.jpg" alt="alt哈尔盖"></p><h1 id="熬茶"><a href="#熬茶" class="headerlink" title="熬茶"></a>熬茶</h1><p>今晚吃饭的时候，我们又喝到了当地人免费提供的茶，喝起来有点咸苦，挺奇怪的味道。借着好奇心询问店家，这是什么茶。</p><blockquote><p>  答：nao茶</p></blockquote><p>这是非常有特色的，值得体验的奇怪的茶，当时有点勉强的在喝，现在竟有点怀念。</p><h1 id="记录总结"><a href="#记录总结" class="headerlink" title="记录总结"></a>记录总结</h1><p>今天一路多云，没下雨挺不错的，就是上坡路有点多，总计骑行53公里。</p><p><img src="https://s3.ax1x.com/2020/12/16/r1Eqt1.md.jpg" alt="alt记录"></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第四天</title>
      <link href="/posts/45267/"/>
      <url>/posts/45267/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="行程安排"><a href="#行程安排" class="headerlink" title="行程安排"></a>行程安排</h1><p>今日的行程是非常值得期待的，黑马河日出、环湖西路、石乃亥、鸟岛、青藏铁路、泉吉乡。当然最值得期待的还是一个晴好的天气了，让我们可以看到最美的风景。</p><h1 id="黑马河日出"><a href="#黑马河日出" class="headerlink" title="黑马河日出"></a>黑马河日出</h1><p>为了看黑马河日出，我跟HS今早6点多就起来了。即使是七月，高原的晚间和早晨依旧寒冷，所以我们裹着旅馆的毯子就出发了。</p><p>出门的第一感觉是真的冷，整得我走路都一跳一跳的。然后是感觉清晨空气挺清新的，尤其是往湖边走去的时候，有种走在朝圣之路的感觉。而我跟HS两人又披着毯子，像极了藏传佛教里的喇嘛，我当时这样想。</p><p>看日出的人还挺多的，身边经过一辆又一辆私家车。甚至还遇到了昨天跟我们一起拼车的朋友，他们从后面骑车追上的我俩，我们互相打过招呼，他们就先骑过去了。</p><p>到湖边的时候，天已经亮的足以看清前方的路了，不过太阳尚未露头。但此时的湖景就已将我迷住。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZNYCR.md.jpg" alt="alt晨湖1"><br><img src="https://s3.ax1x.com/2020/12/12/rZNG59.md.jpg" alt="alt晨湖2"></p><p>当走到观日处早已人山人海，我倒是真没想到居然能在这里看到这么多的人，难怪刚走过来的时候还看到有人在这边搭帐篷露营的。但这边晚上是真的冷，更别说在湖边露营了，为了看日出值得这样疯狂么？</p><p>下一刻，在看到太阳升起的那刻我马上明白了，确实值得。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZt6XT.md.jpg" alt="alt日出1"><br><img src="https://s3.ax1x.com/2020/12/12/rZaRHS.md.jpg" alt="alt日出2"><br><img src="https://s3.ax1x.com/2020/12/12/rZtR74.md.jpg" alt="alt日出3"><br><img src="https://s3.ax1x.com/2020/12/12/rZtrpq.md.jpg" alt="alt日出4"><br><img src="https://s3.ax1x.com/2020/12/12/rZNS3t.jpg" alt="alt日出5"></p><p>甚至开始后悔自己没有起得更早，早点过来站个位置，这样可以像别人一样支个三脚架，拍个绝美日出的视频。也后悔没有叫上阿潘和他同学，虽然昨晚他俩就决定睡懒觉了，但是这日出真的值得把他们从床上拉起来。</p><p>看完日出，天已透亮，离开前又拍了几张湖边的文化建筑。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZNeCn.md.jpg" alt="alt"><br><img src="https://s3.ax1x.com/2020/12/12/rZNPu8.md.jpg" alt="alt"></p><p>真的感谢上天，没有下雨，黑马河日出很壮观，我看到了！</p><h1 id="薰衣草地"><a href="#薰衣草地" class="headerlink" title="薰衣草地"></a>薰衣草地</h1><p>天亮了，我们也吃过饭出发了。今天的天气特别好，风景也很美，出发没多久就看到了一片薰衣草地。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZt4hR.md.jpg" alt="alt薰衣草地1"></p><p><img src="https://s3.ax1x.com/2020/12/12/rZNFHg.md.jpg" alt="alt薰衣草地2"></p><p>顺便打卡拍照，纪念一下。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZNUv6.md.jpg" alt="alt合照1"></p><p><img src="https://s3.ax1x.com/2020/12/12/rZNt81.md.jpg" alt="alt合照2"></p><blockquote><p>小插曲：就在阿潘同学给我跟HS拍完合照不久后，他的车也扎胎了。好在才出黑马河不远，阿潘陪着他回去补了个胎又出发了。</p></blockquote><h1 id="环湖西路"><a href="#环湖西路" class="headerlink" title="环湖西路"></a>环湖西路</h1><p>这是跟青海湖贴的最近的一条路，也是最美的一条路。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZNAEQ.md.jpg" alt="alt湖1"><br><img src="https://s3.ax1x.com/2020/12/12/rZNENj.md.jpg" alt="alt湖2"><br><img src="https://s3.ax1x.com/2020/12/12/rZtv4A.md.jpg" alt="alt湖3"><br><img src="https://s3.ax1x.com/2020/12/12/rZNpgP.md.jpg" alt="alt湖4"></p><p>真的太美了，我还拍了张全景图。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZtXAH.md.jpg" alt="alt全景"></p><p>从HS那里偷来的这张图尤其美。</p><p><img src="https://s3.ax1x.com/2020/12/13/reysbR.md.jpg" alt="alt美"></p><p>更美的是这一路相互加油的骑友，拼过车的两位朋友，还有那位老先生，我们互相加油，一同走在朝圣的路上，这种感觉极好。</p><h1 id="石乃亥"><a href="#石乃亥" class="headerlink" title="石乃亥"></a>石乃亥</h1><p>在爬过一个极陡的坡后，石乃亥就到了，有点意想不到的快。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZtjNd.md.jpg" alt="alt石乃亥"></p><p>在这里我跟HS等了下阿潘跟他同学，顺便休息一下吃了个瓜，整顿完后就一同出发去鸟岛了。</p><p>这段路很平直，车也很少。在人像大师HS的提议下，我们各自留下了值得回忆的照片。</p><p><img src="https://s3.ax1x.com/2020/12/14/rnuXTI.md.jpg" alt="alt留念"></p><h1 id="鸟岛"><a href="#鸟岛" class="headerlink" title="鸟岛"></a>鸟岛</h1><p>通往鸟岛的路很好，这段路不但平缓没什么上坡，而且生态很好。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZtLHe.md.jpg" alt="alt鸟岛"></p><p>在鸟岛吃过午饭后，HS出发去鸟岛景区了，而我们往今天的目标泉吉乡出发了。</p><p>路上看到了只牦牛，下车想近距离拍张照，一下车牦牛似乎很不高兴的往前走了，当时有点害怕。然后我就继续骑车了，追上这头牛的时候跟它对视了一眼，我惊了，那是愤怒的眼神，之后背后的一声吼声更是加剧了我内心的恐惧。回头瞟了眼，确认它没冲过上来拱我就放心了。</p><blockquote><p>对牦牛憨憨的印象一扫而空，为了骑行安全我后来没再下车看过牦牛。</p></blockquote><p><img src="https://s3.ax1x.com/2020/12/12/rZtTc6.md.jpg" alt="alt牦牛"></p><p>骑了挺久，天气突然有变，我突然意识到让HS一个人去鸟岛景区是多么不明智的决定了。因为他骑的是公路车放不了驼包，所以他的雨具都放在我这了。</p><p>往回骑了，幸运的是没回头多久就遇到了HS。没想到的是他也同样遇到了一头暴躁牦牛，在他从牦牛身边经过时差点被顶到。我当时还以为HS遇到的是跟我同一头牦牛，结果是鸟岛景区里的另一头。看来牦牛还是不要太接近的好。</p><h1 id="青藏铁路"><a href="#青藏铁路" class="headerlink" title="青藏铁路"></a>青藏铁路</h1><p>在骑上一座高架桥后终于看到了青藏铁路，守了一会儿就等到了火车。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZtbnO.md.jpg" alt="alt青藏铁路1"><br><img src="https://s3.ax1x.com/2020/12/12/rZto1x.md.jpg" alt="alt青藏铁路2"><br><img src="https://s3.ax1x.com/2020/12/12/rZt7jK.md.jpg" alt="alt青藏铁路3"><br><img src="https://s3.ax1x.com/2020/12/12/rZtI91.md.jpg" alt="alt青藏铁路4"></p><h1 id="泉吉乡"><a href="#泉吉乡" class="headerlink" title="泉吉乡"></a>泉吉乡</h1><p>看过铁路后，天又变灰了，万幸的是在下雨前我们成功赶到了今天的目的地-泉吉。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZtfAJ.md.jpg" alt="alt泉吉乡"></p><h1 id="总结记录"><a href="#总结记录" class="headerlink" title="总结记录"></a>总结记录</h1><p>今天一路体验都很棒，从黑马河到泉吉共计骑行了91公里，但是并没有想象中的那么累，所以天气好的话一天还是能骑挺远的。</p><p><img src="https://s3.ax1x.com/2020/12/15/rMg17F.md.jpg" alt="altrecord1"><br><img src="https://s3.ax1x.com/2020/12/15/rMgN11.md.jpg" alt="altrecord2"></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第三天</title>
      <link href="/posts/56850/"/>
      <url>/posts/56850/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="启程"><a href="#启程" class="headerlink" title="启程"></a>启程</h1><p>今天的目标是上午到黑马河，下午坐车去看茶卡盐湖。</p><p>经历昨天下午的恶劣天气后，今早我们认真准备了雨具，简单地吃过早饭后就出发了。不知道是不是因为昨天下午恶劣天气的影响，今天路上骑行的人少了不少。</p><p>昨天就发现这边草地环境不错，上面有不少小花，今天拍了个照。</p><p><img src="https://s3.ax1x.com/2020/12/10/riK5Ps.md.jpg" alt="alt小花"></p><h1 id="恶劣天气"><a href="#恶劣天气" class="headerlink" title="恶劣天气"></a>恶劣天气</h1><p>上午在前往黑马河的路上，我们一行人受尽了磨难，在这50公里的路上下了三次雨，一次冰雹，一次大风，出了三次太阳。</p><p>在这种天气下赶路的体验，是挺糟糕的。那就是被大雨打湿后，风吹得让人瑟瑟发抖，太阳曝晒得让人神志不清；吹干晒干后又被打湿，然后又被吹干晒干。</p><p>就是这天才发现防晒霜根本不顶用，一波雨就把用心涂抹的防晒霜淋得一干二净，我后来就一直戴着头巾。</p><p>冰雹更是离谱，我们直接弃车，几个人靠着一辆路边的越野车才得以幸免。</p><p>最恐怖的是大风，完全蹬不动车，当我决定弃车的时候，发现车根本立不住，要知道我的山地车还挂着驼包(里面装满了行李)。幸运的是，后来我推着车发现了一个公厕，在那里避的风。</p><p>不幸的是，在大风中阿潘的车扎胎了。然而补胎工具在我身上，我手机还静音了。当我追上阿潘的时候，还无奈的发现我们三个都不会补胎。幸好HS联系了一位司机，好心司机把阿潘跟他同学先带去目的地了。</p><p>因为恶劣天气影响，这一路就只拍了没几张照片。</p><p><img src="https://s3.ax1x.com/2020/12/10/riKo2q.md.jpg" alt="alt这天这路"></p><center>这天这路</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riVpBd.md.jpg" alt="alt湖边牧场"></p><center>湖边牧场</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKfaQ.md.jpg" alt="alt湖边草地"></p><center>湖边草地</center><hr><p>大风过后，我的潜能被彻底激发了，害怕再不快点骑完这段路，会有什么更离谱的恶劣天气在等着我。</p><p>一波血性冲刺后，赶上了正在等我的HS。然后我们又一起出发了。在一个下坡的时候HS的车也扎胎了，然而我依旧处于无脑冲刺中，没有注意到HS扎胎的消息。</p><h1 id="黑马河"><a href="#黑马河" class="headerlink" title="黑马河"></a>黑马河</h1><p>直到我冲到黑马河，掏出手机拍照时才发现问题。</p><p><img src="https://s3.ax1x.com/2020/12/10/riK2qS.md.jpg" alt="alt黑马河"></p><p>拍下路标，确认了消息，马上扭头去救HS了。很快就撞上了推车过来的HS。尴尬的是，补胎工具刚给阿潘了，然后我们也坐上了车。</p><p>总结这两波直接把队友送走的失误操作后，我的手机再没静音过，补胎工具包也一直放在我这不动了。</p><p>司机是当地人，开着一家旅馆。把我们送到旅馆后，还帮我们补了胎。就在这里遇到了同是517俱乐部的三位骑友，其中两位是跟我们年纪一样的大学生，另一位是个和蔼的老先生。下午去盐湖就是跟这两位大学生骑友一起拼的车，司机当然还是那位好心司机。</p><p>简单的吃过午饭后我们就出发了。前往盐湖的路上，心情逐渐舒畅，慢慢忘记了上午的磨难。</p><p>盐湖在柴达木盆地中，不过在进入柴达木盆地前，一路都是高山，有不少悬崖峭壁。跟我们环湖骑行所看到的景色截然不同。</p><p>进入柴达木盆地后，视野突然开阔，眼前出现了大片的风车。</p><h1 id="茶卡盐湖"><a href="#茶卡盐湖" class="headerlink" title="茶卡盐湖"></a>茶卡盐湖</h1><p>不久，就到了盐湖。其实盐湖上个暑假我就来过了，那时候去的还是老景区，这次换新的景区了-天空壹号。拍了不少照片：</p><p><img src="https://s3.ax1x.com/2020/12/10/riEvcD.md.jpg" alt="alt小心火车1"><br><img src="https://s3.ax1x.com/2020/12/10/riKHMV.md.jpg" alt="alt小心火车2"><br><img src="https://s3.ax1x.com/2020/12/10/riKjIJ.md.jpg" alt="alt盐湖上的火车"><br><img src="https://s3.ax1x.com/2020/12/13/reyW8O.md.jpg" alt="alt盐湖火车"></p><center>盐湖上的火车</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKxi9.md.jpg" alt="alt风力发电机组"></p><center>风力发电机组</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKgr8.md.jpg" alt="alt五彩的湖"></p><center>五彩的湖</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKqqU.md.jpg" alt="alt盐湖一览"></p><center>盐湖一览</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKWVg.md.jpg" alt="alt悍匪"></p><center>悍匪</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riKXa4.md.jpg" alt="alt细看湖水"></p><center>细看湖水</center><hr><p>真正看到盐湖也就这样吧，这是我们大家的感受。对于之前去过老景区的我来说，更是觉得这次的体验确实不大理想，有点过于商业化了。不过毕竟是免票游玩(浙江籍免票)，还是希望老乡的新景区能有更好的发展吧。</p><h1 id="记录总结"><a href="#记录总结" class="headerlink" title="记录总结"></a>记录总结</h1><p>今天从江西沟至黑马河，总计骑行50.1公里，虽然四个人整整齐齐都坐车了，但是能经历的都经历也是一件好事吧(指扎胎坐车还有多变的天气)。尤其是这怪天气，当晚洗脸就发现鼻子蜕皮了，疼的很。</p><p><img src="https://s3.ax1x.com/2020/12/10/riKh5j.jpg" alt="alt记录"></p><p>最后推荐一个挺有特色的酸奶-慕拉酸奶，当晚便利店发现的，味道不错。</p><p><img src="https://s3.ax1x.com/2020/12/12/rZ8HoR.md.jpg" alt="alt酸奶"></p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第二天</title>
      <link href="/posts/53867/"/>
      <url>/posts/53867/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="出发"><a href="#出发" class="headerlink" title="出发"></a>出发</h1><p>第二天，环青海湖的骑行正式开始了。计划这天从西海镇到江西沟，大概100多公里，中午湖东种羊场吃饭。</p><p>没有太多的思考，我们包含着热情上路了，发现跟我们一样今天出发的人还挺多的，此时的我们并没有意识到接下来的挑战有多离谱。甚至我还被一路的油菜花吸引了，还没真正看到青海湖，我已经陶醉在花海中。发出不虚此行的感叹。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEDXQ.md.jpg" alt="alt油菜"></p><p>实际上我们正在经历漫长的爬坡阶段，但是周围的景色麻痹了我的神经，当我实在踏不动踏板的时候，我明智地决定推车了。当终于把车推上第一个小山头的时候，一群人早已站在这里休息，欣赏着对面山坡上的羊群。</p><p><img src="https://s3.ax1x.com/2020/12/10/rF0uvT.md.jpg" alt="alt羊群"></p><p>没有做过多的停留我又出发了，因为让大家等我太久属实不好。毕竟这时候连青海湖塔楼(青海湖入口标志性建筑)都还没到。之后在机械地重复踩踏踏板中，热情都给我踏飞咯。</p><h1 id="青海湖塔楼"><a href="#青海湖塔楼" class="headerlink" title="青海湖塔楼"></a>青海湖塔楼</h1><p>幸运的是，不断的爬坡后终于在一次极为离谱的长下坡中，我体会到了单车速度40码的激情，也意识到了目标已经近在咫尺。一波斗志激发，眼前终于出现了塔楼。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEUtP.md.jpg" alt="alt塔楼"></p><p>经典打卡点，给自己也来了一张。当时内心老激动了，感谢摄影师HS和他的爱车。</p><h1 id="青海湖"><a href="#青海湖" class="headerlink" title="青海湖"></a>青海湖</h1><p>过了塔楼没多远的路，就看到青海湖了。在晴好的天气下，远远的看过去海天一线。就跟下图说的那样，青海湖，中国最美丽的湖泊。</p><p><img src="https://s3.ax1x.com/2020/12/10/riE3OH.md.jpg" alt="alt青海湖"></p><p>接下来又是长下坡，所以可想而知，我们当时爬了是有多长的坡。</p><p><img src="https://s3.ax1x.com/2020/12/10/rF0MKU.md.jpg" alt="alt长下坡"></p><p>进入青海湖后首先看到的是一片沙漠，挺神奇的，就在湖边上。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEQSO.md.jpg" alt="alt沙漠"></p><p>好奇心很快又被重复性的踩踏行为，踩在底下。</p><h1 id="湖东种羊场"><a href="#湖东种羊场" class="headerlink" title="湖东种羊场"></a>湖东种羊场</h1><p>不知骑行了多长的路，牛、马、羊开始多起来了，终于到种羊场了。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEKfK.md.jpg" alt="alt种羊场"></p><p>甚至还看到了牦牛，近距离拍了张照片。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEGmd.md.jpg" alt="alt牦牛"></p><p>到餐馆前一副奇怪的风景吸引了我，草地上孤零零的一棵树，这个场景有没有觉得挺美的。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEuY6.md.jpg" alt="alt孤零零的一棵树"></p><p>餐馆吃过饭，小憩了一会儿，我们又出发了。</p><p>虽然正是太阳最猛的时候，但此时在环湖东路上骑行尤其舒爽。从湖所在的方向吹来阵阵凉风，而我们正好下坡，只要负责把脸迎上去接风吹就完了。</p><p>此时望着前方，青海湖越来越近了。</p><p>骑到一处不少人下去观湖的地方，我也下车了。正好我们四个人都有下去观湖的想法，大伙鱼贯而下，一睹圣湖真容。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEJ0A.md.jpg" alt="alt近看青海湖"></p><p>当时天气不好，所以这个真容看上去可能比想象中差了点。</p><h1 id="国道109"><a href="#国道109" class="headerlink" title="国道109"></a>国道109</h1><p>从环湖东路骑到国道109后，噩梦开始了。天气已经不对了，下起了小雨，阿潘身体不适坐车帮我们先去订旅馆了。但我们还在前往二郎剑景区的路上。</p><p>到了二郎剑，从我们的视角(景区外)看二郎剑景区：</p><p><img src="https://s3.ax1x.com/2020/12/10/riEsmj.md.jpg" alt="alt二郎剑"></p><p>风景可能到此告个段落了，因为接下来就遇到糟糕的天气了-阵阵阴雨，还有漫长的缓上坡。</p><p>冷的可怕，当时鞋子已经完全湿透，脚冷。裤子也湿了大半，几乎沉重的蹬不动单车了。这段路上我几乎就是边推边蹬过来的，真的磨练一个人。</p><p>路上看到了一排白塔，终点不远了，我这样安慰自己。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEaff.md.jpg" alt="alt白塔"></p><h1 id="江西沟"><a href="#江西沟" class="headerlink" title="江西沟"></a>江西沟</h1><p>终于到了，如同长征胜利完成一般。</p><p><img src="https://s3.ax1x.com/2020/12/10/riE01S.md.jpg" alt="alt江西沟"></p><h1 id="记录总结"><a href="#记录总结" class="headerlink" title="记录总结"></a>记录总结</h1><p>一行四人都到位了，没有一人落下，完美。只是阿潘有点发烧，担心他接下来的行程是否还能坚持走完。</p><h2 id="行程数据"><a href="#行程数据" class="headerlink" title="行程数据"></a>行程数据</h2><p>因为没有一开始就记录数据，所以我只知道，从青海湖入口塔楼到江西沟，我们骑了有84.4公里。参考HS的记录，这天骑了有100公里。</p><p><img src="https://s3.ax1x.com/2020/12/10/riEYTI.jpg" alt="alt记录"></p><h2 id="身边的悲剧"><a href="#身边的悲剧" class="headerlink" title="身边的悲剧"></a>身边的悲剧</h2><blockquote><p>正好发生在我们住宿的旅馆，发生在一位陌生骑友身上。有点难过。</p></blockquote><p>我所听闻的事情是这样的，这位骑友骑得挺快的，先到了江西沟，定了这个旅馆。然而跟他同行的朋友还在后面所以他又骑回去了。见面后得知他们放弃了骑到江西沟的念头，并在二郎剑定了旅馆后。他又骑回江西沟退钱去了，正好在旅馆前，从车上摔下来把膝盖骨摔坏了。</p><p>我的所见，在国道109上骑行的时候就听到了救护车的声音，当时不以为意，现在回想这身边发生的事不免害怕。</p><p>出门在外还是安全第一，希望这位骑友早日康复。</p>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>环青海湖骑行第一天</title>
      <link href="/posts/16913/"/>
      <url>/posts/16913/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h1><p>关于环青海湖骑行的念头，要不是好朋友HS牵头，我是半点都不会想到的。而且看得出他准备了良久，说来惭愧我在西北上学，他大老远跑过来我应该好生招待的。结果我好像还没他了解青海哈哈哈哈。</p><blockquote><p>最搞笑的是：HS问我，七月青海天气怎么样冷不冷。我直接就是还好，白天穿个短袖刚刚好。😄好家伙，一路骑车下来就没短袖过。</p></blockquote><p>我们一行四个人，我、HS、大学室友阿潘还有他的初中同学。</p><h1 id="行程"><a href="#行程" class="headerlink" title="行程"></a>行程</h1><p>第一天，主要是准备阶段，我们一早从青海省城-西宁出发乘大巴车到西海镇。说是一早其实都9点多了吧，大巴到西海镇刚好中午。到客运中心后，骑行俱乐部有车接送，直接送到我们此行的真正起点-517骑行俱乐部，也是我们启程后的终点。现在后悔自己没有给它拍一张照片了，所以下图嫖自摄影师HS的朋友圈：</p><p><img src="https://s3.ax1x.com/2020/12/10/riAtRU.md.jpg" alt="alt517"></p><h2 id="初识原子城"><a href="#初识原子城" class="headerlink" title="初识原子城"></a>初识原子城</h2><p>哦对了，作为看惯钢筋混凝土的人，初到原子城<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="西海镇，也称中国原子城，最早没有城镇，只有一些牧民的定居点。因为科研人员在这里研制原子弹才诞生的小镇，所以也称原子城。">[1]</span></a></sup>会有很神奇的感受。</p><p>就是这里研究过核武器的历史，配合居住区每幢楼墙体上，带有政治色彩的宣传标语，仿佛把我带入了那个充满热血的红色时代。而原子城又坐落在大草原上，被广袤的草原环绕。然后当时正好下着雨，天空灰蒙蒙的。怎么说呢，热血的红色被静谧的绿色包裹，又被忧郁的灰色盖在底下，就是这么神奇的感受。</p><p>但实际上热血的红色仅仅是建筑、历史文化带给我的感受，相反镇上的人带给我的是草原的静谧。他们或许看上去表现的很冷淡，但实际上很热情。</p><blockquote><p>小故事：当时正好推着车去吃饭，因为车上放着行李挺重的，路人直接来帮我推了。</p></blockquote><p>这就是我眼中的西海小镇和小镇上的人，神奇美妙。</p><h2 id="原子纪念馆"><a href="#原子纪念馆" class="headerlink" title="原子纪念馆"></a>原子纪念馆</h2><p>租完单车，在酒店整顿完行李，正好雨也停了。我跟HS俩人便去试车了。先是去看了原子纪念馆，因为不能拍照，所以只有下面这个远景图。</p><p><img src="https://s3.ax1x.com/2020/12/10/riAJiV.md.jpg" alt="alt纪念馆"></p><h2 id="金银滩草原"><a href="#金银滩草原" class="headerlink" title="金银滩草原"></a>金银滩草原</h2><p>看完纪念馆，我俩就去看外面的金银滩草原了。一眼看上草原，两个字，喜欢。眼中只剩下蓝天、白云、绿草。</p><p><img src="https://s3.ax1x.com/2020/12/10/riAaM4.md.jpg" alt="alt金银滩草原"></p><center>金银滩草原</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riArIx.md.jpg" alt="alt空荡的公路"></p><center>空荡的公路</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riAYGT.md.jpg" alt="alt特色路标"></p><center>特色路标</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riA8I0.md.jpg" alt="alt牛羊"></p><center>牛羊</center><hr><p><img src="https://s3.ax1x.com/2020/12/10/riAdsJ.md.jpg" alt="alt五彩经幡"></p><center>五彩经幡</center><h1 id="吃食"><a href="#吃食" class="headerlink" title="吃食"></a>吃食</h1><p>第一感觉就是价格贵了一倍，东西种类还少了。</p><p>但是我们还是吃了两顿大餐。中午汉堡店吃鸡，晚上餐馆吃炒菜，吃到了牦牛肉，味道还行，但还是更喜欢吃惯了的普通牛肉。还有另一个当地特产黄蘑菇，挺不错的，我都推荐。</p><p>虽然喜欢美食，但是对美食的嗅觉我是向来都不灵敏的。所以我也就扬长避短不多介绍了。</p><h1 id="睡前"><a href="#睡前" class="headerlink" title="睡前"></a>睡前</h1><p>被HS逗笑了，在明天就要准备出行的激动的晚上，他在挑灯写英语作业。看得出这波是说走就走的骑行，被他的精神感动到了。</p><p>又有点回想起高中的岁月，好像我们当时就是这副样子的。但是我现在却不大认识自己了，不知道自己发生了什么。不过眼前的HS是本人没错了。</p><blockquote><p>有这种想法可能是因为太久没联系了吧，突然意识到自己的糟糕之处了，朋友还是得多联系的。</p></blockquote><h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">西海镇，也称中国原子城，最早没有城镇，只有一些牧民的定居点。因为科研人员在这里研制原子弹才诞生的小镇，所以也称原子城。<a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>]]></content>
      
      
      <categories>
          
          <category> 生活杂记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 随记 </tag>
            
            <tag> 骑行 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
